!function(){var e={53316:function(e){function t(e,t,r,o){var n,s=null==(n=o)||"number"==typeof n||"boolean"==typeof n?o:r(o),a=t.get(s);return void 0===a&&(a=e.call(this,o),t.set(s,a)),a}function r(e,t,r){var o=Array.prototype.slice.call(arguments,3),n=r(o),s=t.get(n);return void 0===s&&(s=e.apply(this,o),t.set(n,s)),s}function o(e,t,r,o,n){return r.bind(t,e,o,n)}function n(e,n){return o(e,this,1===e.length?t:r,n.cache.create(),n.serializer)}function s(){return JSON.stringify(arguments)}function a(){this.cache=Object.create(null)}a.prototype.has=function(e){return e in this.cache},a.prototype.get=function(e){return this.cache[e]},a.prototype.set=function(e,t){this.cache[e]=t};var i={create:function(){return new a}};e.exports=function(e,t){var r=t&&t.cache?t.cache:i,o=t&&t.serializer?t.serializer:s;return(t&&t.strategy?t.strategy:n)(e,{cache:r,serializer:o})},e.exports.strategies={variadic:function(e,t){return o(e,this,r,t.cache.create(),t.serializer)},monadic:function(e,r){return o(e,this,t,r.cache.create(),r.serializer)}}},33042:function(e,t,r){var o;!function(){"use strict";var n=function e(t){var r,o="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element"),n={use_static:!1};function s(e){var t=Object.getPrototypeOf(e);return t?Object.create(t):{}}function a(e,t,r){Object.defineProperty(e,t,{enumerable:!1,configurable:!1,writable:!1,value:r})}function i(e,t){a(e,t,(function(){throw new b("The "+t+" method cannot be invoked on an Immutable data structure.")}))}"object"!=typeof(r=t)||Array.isArray(r)||null===r||void 0!==t.use_static&&(n.use_static=Boolean(t.use_static));var l="__immutable_invariants_hold";function u(e){return"object"!=typeof e||(null===e||Boolean(Object.getOwnPropertyDescriptor(e,l)))}function p(e,t){return e===t||e!=e&&t!=t}function d(e){return!(null===e||"object"!=typeof e||Array.isArray(e)||e instanceof Date)}var c=["setPrototypeOf"],g=c.concat(["push","pop","sort","splice","shift","unshift","reverse"]),m=["keys"].concat(["map","filter","slice","concat","reduce","reduceRight"]),f=c.concat(["setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"]);function b(e){this.name="MyError",this.message=e,this.stack=(new Error).stack}function E(e,t){for(var r in a(e,l,!0),t)t.hasOwnProperty(r)&&i(e,t[r]);return Object.freeze(e),e}function I(e,t){var r=e[t];a(e,t,(function(){return z(r.apply(e,arguments))}))}function y(e,t,r){var o=r&&r.deep;if(e in this&&(o&&this[e]!==t&&d(t)&&d(this[e])&&(t=z.merge(this[e],t,{deep:!0,mode:"replace"})),p(this[e],t)))return this;var n=A.call(this);return n[e]=z(t),P(n)}b.prototype=new Error,b.prototype.constructor=Error;var O=z([]);function _(e,t,r){var o=e[0];if(1===e.length)return y.call(this,o,t,r);var n,s=e.slice(1),a=this[o];if("object"==typeof a&&null!==a)n=z.setIn(a,s,t);else{var i=s[0];n=""!==i&&isFinite(i)?_.call(O,s,t):U.call(w,s,t)}if(o in this&&a===n)return this;var l=A.call(this);return l[o]=n,P(l)}function P(e){for(var t in m){if(m.hasOwnProperty(t))I(e,m[t])}n.use_static||(a(e,"flatMap",v),a(e,"asObject",N),a(e,"asMutable",A),a(e,"set",y),a(e,"setIn",_),a(e,"update",B),a(e,"updateIn",k),a(e,"getIn",$));for(var r=0,o=e.length;r<o;r++)e[r]=z(e[r]);return E(e,g)}function T(){return new Date(this.getTime())}function v(e){if(0===arguments.length)return this;var t,r=[],o=this.length;for(t=0;t<o;t++){var n=e(this[t],t,this);Array.isArray(n)?r.push.apply(r,n):r.push(n)}return P(r)}function S(e){if(void 0===e&&0===arguments.length)return this;if("function"!=typeof e){var t=Array.isArray(e)?e.slice():Array.prototype.slice.call(arguments);t.forEach((function(e,t,r){"number"==typeof e&&(r[t]=e.toString())})),e=function(e,r){return-1!==t.indexOf(r)}}var r=s(this);for(var o in this)this.hasOwnProperty(o)&&!1===e(this[o],o)&&(r[o]=this[o]);return x(r)}function A(e){var t,r,o=[];if(e&&e.deep)for(t=0,r=this.length;t<r;t++)o.push(h(this[t]));else for(t=0,r=this.length;t<r;t++)o.push(this[t]);return o}function N(e){"function"!=typeof e&&(e=function(e){return e});var t,r={},o=this.length;for(t=0;t<o;t++){var n=e(this[t],t,this),s=n[0],a=n[1];r[s]=a}return x(r)}function h(e){return!e||"object"!=typeof e||!Object.getOwnPropertyDescriptor(e,l)||e instanceof Date?e:z.asMutable(e,{deep:!0})}function G(e,t){for(var r in e)Object.getOwnPropertyDescriptor(e,r)&&(t[r]=e[r]);return t}function R(e,t){if(0===arguments.length)return this;if(null===e||"object"!=typeof e)throw new TypeError("Immutable#merge can only be invoked with objects or arrays, not "+JSON.stringify(e));var r,o,n=Array.isArray(e),a=t&&t.deep,i=t&&t.mode||"merge",l=t&&t.merger;function u(e,o,n){var i,u=z(o[n]),c=l&&l(e[n],u,t),g=e[n];void 0===r&&void 0===c&&e.hasOwnProperty(n)&&p(u,g)||(p(g,i=void 0!==c?c:a&&d(g)&&d(u)?z.merge(g,u,t):u)&&e.hasOwnProperty(n)||(void 0===r&&(r=G(e,s(e))),r[n]=i))}function c(e,t){for(var o in e)t.hasOwnProperty(o)||(void 0===r&&(r=G(e,s(e))),delete r[o])}if(n)for(var g=0,m=e.length;g<m;g++){var f=e[g];for(o in f)f.hasOwnProperty(o)&&u(void 0!==r?r:this,f,o)}else{for(o in e)Object.getOwnPropertyDescriptor(e,o)&&u(this,e,o);"replace"===i&&c(this,e)}return void 0===r?this:x(r)}function L(e,t){var r=t&&t.deep;if(0===arguments.length)return this;if(null===e||"object"!=typeof e)throw new TypeError("Immutable#replace can only be invoked with objects or arrays, not "+JSON.stringify(e));return z.merge(this,e,{deep:r,mode:"replace"})}var D,C,M,w=z({});function U(e,t,r){if(!Array.isArray(e)||0===e.length)throw new TypeError('The first argument to Immutable#setIn must be an array containing at least one "key" string.');var o=e[0];if(1===e.length)return V.call(this,o,t,r);var n,a=e.slice(1),i=this[o];if(n=this.hasOwnProperty(o)&&"object"==typeof i&&null!==i?z.setIn(i,a,t):U.call(w,a,t),this.hasOwnProperty(o)&&i===n)return this;var l=G(this,s(this));return l[o]=n,x(l)}function V(e,t,r){var o=r&&r.deep;if(this.hasOwnProperty(e)&&(o&&this[e]!==t&&d(t)&&d(this[e])&&(t=z.merge(this[e],t,{deep:!0,mode:"replace"})),p(this[e],t)))return this;var n=G(this,s(this));return n[e]=z(t),x(n)}function B(e,t){var r=Array.prototype.slice.call(arguments,2),o=this[e];return z.set(this,e,t.apply(o,[o].concat(r)))}function j(e,t){for(var r=0,o=t.length;null!=e&&r<o;r++)e=e[t[r]];return r&&r==o?e:void 0}function k(e,t){var r=Array.prototype.slice.call(arguments,2),o=j(this,e);return z.setIn(this,e,t.apply(o,[o].concat(r)))}function $(e,t){var r=j(this,e);return void 0===r?t:r}function F(e){var t,r=s(this);if(e&&e.deep)for(t in this)this.hasOwnProperty(t)&&(r[t]=h(this[t]));else for(t in this)this.hasOwnProperty(t)&&(r[t]=this[t]);return r}function W(){return{}}function x(e){return n.use_static||(a(e,"merge",R),a(e,"replace",L),a(e,"without",S),a(e,"asMutable",F),a(e,"set",V),a(e,"setIn",U),a(e,"update",B),a(e,"updateIn",k),a(e,"getIn",$)),E(e,c)}function z(e,t,r){if(u(e)||function(e){return"object"==typeof e&&null!==e&&(60103===e.$$typeof||e.$$typeof===o)}(e)||function(e){return"undefined"!=typeof File&&e instanceof File}(e)||function(e){return"undefined"!=typeof Blob&&e instanceof Blob}(e)||function(e){return e instanceof Error}(e))return e;if(function(e){return"object"==typeof e&&"function"==typeof e.then}(e))return e.then(z);if(Array.isArray(e))return P(e.slice());if(e instanceof Date)return s=new Date(e.getTime()),n.use_static||a(s,"asMutable",T),E(s,f);var s,i=t&&t.prototype,l=(i&&i!==Object.prototype?function(){return Object.create(i)}:W)();if(null==r&&(r=64),r<=0)throw new b("Attempt to construct Immutable from a deeply nested object was detected. Have you tried to wrap an object with circular references (e.g. React element)? See https://github.com/rtfeldman/seamless-immutable/wiki/Deeply-nested-object-was-detected for details.");for(var p in r-=1,e)Object.getOwnPropertyDescriptor(e,p)&&(l[p]=z(e[p],void 0,r));return x(l)}function Y(e){return function(){var t=[].slice.call(arguments),r=t.shift();return e.apply(r,t)}}function K(e,t){return function(){var r=[].slice.call(arguments),o=r.shift();return Array.isArray(o)?t.apply(o,r):e.apply(o,r)}}return z.from=z,z.isImmutable=u,z.ImmutableError=b,z.merge=Y(R),z.replace=Y(L),z.without=Y(S),z.asMutable=(D=F,C=A,M=T,function(){var e=[].slice.call(arguments),t=e.shift();return Array.isArray(t)?C.apply(t,e):t instanceof Date?M.apply(t,e):D.apply(t,e)}),z.set=K(V,y),z.setIn=K(U,_),z.update=Y(B),z.updateIn=Y(k),z.getIn=Y($),z.flatMap=Y(v),z.asObject=Y(N),n.use_static||(z.static=e({use_static:!0})),Object.freeze(z),z}();void 0===(o=function(){return n}.call(t,r,t,e))||(e.exports=o)}()}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,r),s.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};!function(){"use strict";r.r(o),r.d(o,{GlobalDataStyle:function(){return Ir},GlobalDataStyleContainer:function(){return yr},addDefaultModulePreset:function(){return z},addDefaultOptionGroupPreset:function(){return Le},addFontColorVariable:function(){return f},addGlobalColor:function(){return j},addGlobalVariable:function(){return we},addGlobalVariables:function(){return Ue},addNewOptionGroupPreset:function(){return Ge},addNewOptionGroupPresetFromCurrentStyles:function(){return Ne},addNewPreset:function(){return Y},addNewPresetFromCurrentStyles:function(){return K},addPresetAttrsMapJob:function(){return ue},assignOptionGroupPresetToDefault:function(){return Re},assignPresetToDefault:function(){return J},bootstrapGlobalVariables:function(){return m},cloneOptionGroupPreset:function(){return Ae},clonePreset:function(){return H},closeConfirmationModal:function(){return q},closeOptionGroupConfirmationModal:function(){return Z},closeOptionGroupPresetEditMode:function(){return Ce},closeOptionGroupPresetModal:function(){return De},closePresetModal:function(){return Q},deleteGlobalColor:function(){return k},deleteGlobalVariable:function(){return Ve},deleteModulePreset:function(){return X},deleteOptionGroupPreset:function(){return he},editPresetAttribute:function(){return ee},effects:function(){return mr},endPresetEditSession:function(){return fe},endSyncingPreset:function(){return ye},findDependentGlobalColors:function(){return b},generateDefaultPresetName:function(){return O},generateNanoUuid:function(){return y},generateNewOptionGroupPreset:function(){return _},generateNewPreset:function(){return P},generateVariableId:function(){return T},getActiveGlobalColorsMap:function(){return or},getAllGroupPresetData:function(){return Ht},getAllPresetData:function(){return $t},getAllowedActions:function(){return g},getDefaultPreset:function(){return _t},getDefaultPresetID:function(){return Ot},getDefaultPresetOnSave:function(){return jt},getFormattedCSSValue:function(){return v},getGlobalColorBasedOnCssVariable:function(){return Dt},getGlobalColorById:function(){return lt},getGlobalColorIdFromValue:function(){return S},getGlobalColorLabel:function(){return ht},getGlobalColorPalette:function(){return pt},getGlobalColorValue:function(){return yt},getGlobalColors:function(){return dt},getGlobalColorsByStatus:function(){return mt},getGlobalColorsToExport:function(){return Et},getGlobalOrPreviewColorValue:function(){return xt},getGlobalOrPreviewColorValues:function(){return zt},getGlobalPreviewColors:function(){return gt},getGlobalVariable:function(){return A},getGlobalVariableByGroup:function(){return tr},getGlobalVariableById:function(){return er},getGlobalVariableValue:function(){return N},getGlobalVariables:function(){return rr},getGlobalVariablesToExport:function(){return It},getGroupPreset:function(){return Kt},getGroupPresets:function(){return Jt},getGroupsForDefaultPreset:function(){return Qt},getLegacyGlobalColors:function(){return ct},getModulePreset:function(){return Pt},getModulePresets:function(){return vt},getModulePresetsList:function(){return St},getOptionGroupPresetConfirmationModal:function(){return it},getOptionGroupPresetEditMode:function(){return Zt},getOptionGroupPresetModalState:function(){return Yt},getOptionGroupPresetSaveConfirmationDialogFlag:function(){return Xt},getPresetAttr:function(){return At},getPresetAttrsMap:function(){return Bt},getPresetAttrsMapJobs:function(){return Vt},getPresetConfirmationModal:function(){return at},getPresetSaveConfirmationDialogFlag:function(){return Ft},getPreviewGlobalColors:function(){return Wt},getRenderableValue:function(){return Nt},importGlobalColors:function(){return $},importPresets:function(){return le},isActiveConfirmationModal:function(){return Rt},isActiveGlobalColor:function(){return Ct},isActiveOptionGroupConfirmationModal:function(){return Lt},isActiveOptionGroupPresetModal:function(){return Ut},isActivePreset:function(){return wt},isCustomizerFontVariable:function(){return C},isGlobalColor:function(){return h},isGlobalColorEditing:function(){return Mt},isGlobalColorRemovable:function(){return Gt},isGlobalVariable:function(){return G},isGlobalVariableValue:function(){return R},isOptionGroupPresetEditing:function(){return qt},isPresetSyncing:function(){return kt},normalizeOptionGroupPresetId:function(){return L},normalizePresetId:function(){return D},openConfirmationModal:function(){return te},openOptionGroupConfirmationModal:function(){return re},openOptionGroupPresetModal:function(){return ne},openPresetModal:function(){return oe},overridePresetData:function(){return Ee},processGlobalVariableColor:function(){return w},registerGlobalDataStore:function(){return Er},removeGlobalColorPreviewValue:function(){return Pe},removePresetAttribute:function(){return se},resetGlobalVariables:function(){return Fe},resolveGlobalColorVariable:function(){return V},resolveNestedGlobalColor:function(){return B},restoreGlobalVariable:function(){return We},saveGlobalVariables:function(){return xe},savePreset:function(){return Ie},setDefaultPresetOnSave:function(){return de},setGlobalColorPreviewValue:function(){return Te},setIsGlobalColorEditing:function(){return ce},setOptionGroupPresetEditMode:function(){return ge},setPresetAttrsMap:function(){return pe},startPresetEditSession:function(){return be},startSyncingPreset:function(){return Oe},toggleOptionGroupPresetSaveConfirmationDialog:function(){return Me},togglePresetSaveConfirmationDialog:function(){return _e},transformStateIntoGlobalColorValue:function(){return M},unsetDefaultPresetOnSave:function(){return me},updateGlobalColor:function(){return F},updateGlobalColors:function(){return W},updateGlobalColorsUsedInPosts:function(){return x},updateGlobalVariable:function(){return Be},updateGlobalVariableOrder:function(){return ke},updateGlobalVariables:function(){return je},updateGlobalVariablesBackup:function(){return $e},updateOptionGroupPresetName:function(){return Se},updateOptionGroupPresetWithCurrentStyles:function(){return ve},updatePresetName:function(){return ae},updatePresetWithCurrentStyles:function(){return ie}});var e={};r.r(e),r.d(e,{addDefaultModulePreset:function(){return z},addDefaultOptionGroupPreset:function(){return Le},addGlobalColor:function(){return j},addGlobalVariable:function(){return we},addGlobalVariables:function(){return Ue},addNewOptionGroupPreset:function(){return Ge},addNewOptionGroupPresetFromCurrentStyles:function(){return Ne},addNewPreset:function(){return Y},addNewPresetFromCurrentStyles:function(){return K},addPresetAttrsMapJob:function(){return ue},assignOptionGroupPresetToDefault:function(){return Re},assignPresetToDefault:function(){return J},cloneOptionGroupPreset:function(){return Ae},clonePreset:function(){return H},closeConfirmationModal:function(){return q},closeOptionGroupConfirmationModal:function(){return Z},closeOptionGroupPresetEditMode:function(){return Ce},closeOptionGroupPresetModal:function(){return De},closePresetModal:function(){return Q},deleteGlobalColor:function(){return k},deleteGlobalVariable:function(){return Ve},deleteModulePreset:function(){return X},deleteOptionGroupPreset:function(){return he},editPresetAttribute:function(){return ee},endPresetEditSession:function(){return fe},endSyncingPreset:function(){return ye},importGlobalColors:function(){return $},importPresets:function(){return le},openConfirmationModal:function(){return te},openOptionGroupConfirmationModal:function(){return re},openOptionGroupPresetModal:function(){return ne},openPresetModal:function(){return oe},overridePresetData:function(){return Ee},removeGlobalColorPreviewValue:function(){return Pe},removePresetAttribute:function(){return se},resetGlobalVariables:function(){return Fe},restoreGlobalVariable:function(){return We},saveGlobalVariables:function(){return xe},savePreset:function(){return Ie},setDefaultPresetOnSave:function(){return de},setGlobalColorPreviewValue:function(){return Te},setIsGlobalColorEditing:function(){return ce},setOptionGroupPresetEditMode:function(){return ge},setPresetAttrsMap:function(){return pe},startPresetEditSession:function(){return be},startSyncingPreset:function(){return Oe},toggleOptionGroupPresetSaveConfirmationDialog:function(){return Me},togglePresetSaveConfirmationDialog:function(){return _e},unsetDefaultPresetOnSave:function(){return me},updateGlobalColor:function(){return F},updateGlobalColors:function(){return W},updateGlobalColorsUsedInPosts:function(){return x},updateGlobalVariable:function(){return Be},updateGlobalVariableOrder:function(){return ke},updateGlobalVariables:function(){return je},updateGlobalVariablesBackup:function(){return $e},updateOptionGroupPresetName:function(){return Se},updateOptionGroupPresetWithCurrentStyles:function(){return ve},updatePresetName:function(){return ae},updatePresetWithCurrentStyles:function(){return ie}});var t={};r.r(t),r.d(t,{getActiveGlobalColorsMap:function(){return or},getAllGroupPresetData:function(){return Ht},getAllPresetData:function(){return $t},getDefaultPreset:function(){return _t},getDefaultPresetID:function(){return Ot},getDefaultPresetOnSave:function(){return jt},getGlobalColorBasedOnCssVariable:function(){return Dt},getGlobalColorById:function(){return lt},getGlobalColorLabel:function(){return ht},getGlobalColorPalette:function(){return pt},getGlobalColorValue:function(){return yt},getGlobalColors:function(){return dt},getGlobalColorsByStatus:function(){return mt},getGlobalColorsToExport:function(){return Et},getGlobalOrPreviewColorValue:function(){return xt},getGlobalOrPreviewColorValues:function(){return zt},getGlobalPreviewColors:function(){return gt},getGlobalVariableByGroup:function(){return tr},getGlobalVariableById:function(){return er},getGlobalVariables:function(){return rr},getGlobalVariablesToExport:function(){return It},getGroupPreset:function(){return Kt},getGroupPresets:function(){return Jt},getGroupsForDefaultPreset:function(){return Qt},getLegacyGlobalColors:function(){return ct},getModulePreset:function(){return Pt},getModulePresets:function(){return vt},getModulePresetsList:function(){return St},getOptionGroupPresetConfirmationModal:function(){return it},getOptionGroupPresetEditMode:function(){return Zt},getOptionGroupPresetModalState:function(){return Yt},getOptionGroupPresetSaveConfirmationDialogFlag:function(){return Xt},getPresetAttr:function(){return At},getPresetAttrsMap:function(){return Bt},getPresetAttrsMapJobs:function(){return Vt},getPresetConfirmationModal:function(){return at},getPresetSaveConfirmationDialogFlag:function(){return Ft},getPreviewGlobalColors:function(){return Wt},getRenderableValue:function(){return Nt},isActiveConfirmationModal:function(){return Rt},isActiveGlobalColor:function(){return Ct},isActiveOptionGroupConfirmationModal:function(){return Lt},isActiveOptionGroupPresetModal:function(){return Ut},isActivePreset:function(){return wt},isGlobalColorEditing:function(){return Mt},isGlobalColorRemovable:function(){return Gt},isOptionGroupPresetEditing:function(){return qt},isPresetSyncing:function(){return kt}});var n=window.lodash,s=r(33042),a=r.n(s),i=window.divi.colors,l=window.divi.data,u=window.divi.fonts,p=window.divi.middleware,d=window.divi.moduleUtils,c=window.divi.settings;const g=e=>{const t={editLabel:!0,editValue:!0,remove:!0,reorder:!0};return"customizer"===e&&(t.editLabel=!1,t.remove=!1,t.reorder=!1),t},m=e=>{const t=(0,l.select)("divi/fonts").getCustomizerFonts(),{heading:r,body:o}=t,n=(0,l.select)("divi/global-data").getGlobalColors()??{};if(e.includes("fonts")){const e=[];r?.fontId&&e.push({id:r.fontId,label:r.label,value:r.fontName,groupKey:"fonts",status:"active",order:1,allowedActions:g("customizer")}),o?.fontId&&e.push({id:o.fontId,label:o.label,value:o.fontName,groupKey:"fonts",status:"active",order:2,allowedActions:g("customizer")}),e.length>0&&(0,l.dispatch)("divi/global-data").updateGlobalVariables(e)}if(e.includes("colors")){const e=[];Object.entries(n).forEach((([t,{color:r,label:o,folder:n,status:s,order:a,lastUpdated:i}],l)=>{e.push({id:t,label:o||r,value:r,groupKey:"colors",status:"active"===s?s:"archived",allowedActions:g(n),order:a||l+1,lastUpdated:i})})),(0,l.dispatch)("divi/global-data").updateGlobalVariables(e)}},f=(e,t,r,o,n,s,a,i)=>{(0,l.dispatch)("divi/global-data").addGlobalVariable({id:t,label:r,value:o,allowedActions:n,lastUpdated:i,order:s,groupKey:e,status:"active"===a?a:"archived"})},b=(e,t)=>{const r=[];return Object.entries(t).forEach((([o,n])=>{if(o===e)return;const s=n?.color||"";if("string"==typeof s&&s.includes(`"name":"${e}"`)){r.push(o);const e=b(o,t);r.push(...e)}})),r.push(e),Array.from(new Set(r))};let E=e=>crypto.getRandomValues(new Uint8Array(e)),I=(e,t=21)=>((e,t,r)=>{let o=(2<<Math.log(e.length-1)/Math.LN2)-1,n=-~(1.6*o*t/e.length);return(s=t)=>{let a="";for(;;){let t=r(n),i=n;for(;i--;)if(a+=e[t[i]&o]||"",a.length===s)return a}}})(e,t,E);const y=()=>I("0123456789abcdefghijklmnopqrstuvwxyz",10)(),O=(e,t)=>{const r=e=>`${t} ${e}`;if(!e.length)return{id:y(),name:r(1)};const o=new RegExp(`^${t} (\\d+)$`,"i"),n=e.filter((e=>o.test(e)));if(!n.length)return{id:y(),name:r(1)};const s=n.sort(((e,t)=>{const r=Number(o.exec(e)[1]);return Number(o.exec(t)[1])-r})),a=o.exec(s[0]),i=Number(a[1])+1;return{id:y(),name:r(i)}},_=({presets:e,groupLabel:t,groupName:r,moduleName:o,attrs:s={},renderAttrs:a={},styleAttrs:i={},version:l,created:u,updated:p,groupId:c,primaryAttrName:g})=>{const{id:m,name:f}=O(e,t),b={type:"group",id:m,name:f,version:l,created:u,updated:p,groupName:r,moduleName:o,groupId:c};(0,n.isEmpty)(s)||(b.attrs=s),(0,n.isEmpty)(a)||(b.renderAttrs=a),(0,n.isEmpty)(i)||(b.styleAttrs=i);const E=(0,d.optionGroupPresetPrimaryAttrNameResolver)({primaryAttrName:g,groupId:c,groupName:r,moduleName:o});return E&&(b.primaryAttrName=E),b},P=({presets:e,moduleLabel:t,moduleName:r,attrs:o={},renderAttrs:s={},styleAttrs:a={},type:i="module",version:l="5.0.0",created:u,updated:p})=>{const{id:d,name:c}=O(e,t),g={id:d,name:c,moduleName:r,version:l,type:i,created:u,updated:p};return(0,n.isEmpty)(o)||(g.attrs=o),(0,n.isEmpty)(s)||(g.renderAttrs=s),(0,n.isEmpty)(a)||(g.styleAttrs=a),g},T=(e,t)=>e||("colors"===t?`gcid-${y()}`:`gvid-${y()}`),v=(e,t)=>e.startsWith("--")?`${e}: ${t} !important;`:`--${e}: ${t};`,S=({value:e})=>{if("string"!=typeof e)return null;const t=/--gcid-([0-9a-z-]*)/.exec(e);return t&&t.length>=2?`gcid-${t[1]}`:null},A=e=>(0,l.select)("divi/global-data").getGlobalVariableById(e),N=e=>A(e)?.value??null,h=e=>Boolean(S({value:e})),G=e=>!!e&&(!(!e.startsWith("gvid")&&!e.startsWith("gcid"))||!!["--et_global_heading_font","--et_global_body_font"].includes(e)),R=(e,t)=>{if(!e||"string"!=typeof e)return!1;const r=/^\$variable\((.+?)\)\$$/.exec(e);if(!r)return!1;try{const e=JSON.parse(r[1]);if(!e||"object"!=typeof e||Array.isArray(e))return!1;return!!(e=>{const t=e;return"type"in e&&"value"in e&&"string"==typeof t.type&&"object"==typeof t.value&&null!==t.value&&"name"in t.value&&"string"==typeof t.value.name})(e)&&e.type===t}catch{return!1}},L=({presetId:e,groupName:t,state:r})=>(0,d.getSelectedPresetOrDefault)(e,r.getIn(["presets","items","group",t,"default"])),D=({id:e,moduleName:t,state:r})=>(0,d.getSelectedPresetOrDefault)(e,r.getIn(["presets","items","module",t,"default"])),C=e=>["--et_global_heading_font","--et_global_body_font"].includes(e),M=({cssVariable:e,globalColorSettings:t})=>{let r=e;if(t&&Object.keys(t).length>0){const o=t.hue??0,n=t.saturation??0,s=t.lightness??0,a=t.opacity??null,i=null!==a&&100!==a?" / "+a/100:"",l=(e,t)=>`calc(${e}${t>=0?" + ":" - "}${Math.abs(t)})`,u=l("h",o),p=l("s",n),d=l("l",s);if(0===o&&0===n&&0===s&&(null===a||100===a))return e;r=`hsl(from ${e} ${u} ${p} ${d}${i})`}return r},w=e=>{if(!e||"string"!=typeof e||!e.startsWith("$variable"))return e;const t=/\$variable\((.+?)\)\$/.exec(e);if(t)try{const e=JSON.parse(t[1]),r=`var(--${(e?.value?.name||"").replace(/^--/,"")})`;return"color"===e.type?M({cssVariable:r,globalColorSettings:e.value?.settings}):r}catch(t){console.warn("Failed to parse variable reference:",e,t)}return e},U=e=>/^gcid-[0-9a-z-]+$/.test(e),V=(e,t,r=0,o=!1)=>{if(r>=10)return console.warn("resolveGlobalColorVariable: Maximum recursion depth (10) reached for color:",e),e;if((h(e)||U(e))&&t?.[e]){const n=t[e];return R(n,"color")||(h(n)||U(n))&&t?.[n]?V(n,t,r+1,o):n}if(R(e,"color")){const a=(0,d.parseDynamicData)(e);if(!1!==a&&a?.value){const e=a.value.name,i=e?t?.[e]:null;if(i&&e){const{settings:l}=a.value,u=!l||"object"!=typeof l||"before"in l||"after"in l?{}:l,p=R(i,"color")?V(i,t,r+1,o):i;if(0===Object.keys(u).length)return p;if(o&&p.startsWith("hsl(from")){const e=p.match(/hsl\(from ([^)]+) calc\(h ([+-]) ([^)]+)\) calc\(s ([+-]) ([^)]+)\) calc\(l ([+-]) ([^)]+)\)/);if(e){const t=e[1],r=parseInt(e[3])*("+"===e[2]?1:-1),o=parseInt(e[5])*("+"===e[4]?1:-1),a=parseInt(e[7])*("+"===e[6]?1:-1),i=(n={hue:r,saturation:o,lightness:a},s={hue:u.hue||0,saturation:u.saturation||0,lightness:u.lightness||0},{hue:n.hue+s.hue,saturation:n.saturation+s.saturation,lightness:n.lightness+s.lightness}),l=(e,t)=>`calc(${e}${t>=0?" + ":" - "}${Math.abs(t)})`,p=l("h",i.hue||0),d=l("s",i.saturation||0),c=l("l",i.lightness||0),{opacity:g}=u;return`hsl(from ${t} ${p} ${d} ${c}${null!=g&&100!==g?" / "+g/100:""})`}}const d=M({cssVariable:`var(--${e})`,globalColorSettings:u});return d.includes(`var(--${e})`)?d.replace(`var(--${e})`,p):d}}}var n,s;if("string"==typeof e&&e.includes("hsl(from var(--")&&e.includes("gcid-")){const n=e.match(/var\(--([^)]+)\)/);if(n&&n[1]){const s=t?.[n[1]];if(s){const n=R(s,"color")?V(s,t,r+1,o):s;return e.replace(/var\(--[^)]+\)/,n)}}}return e},B=(e,t,r=new Set,o={hue:0,saturation:0,lightness:0})=>{if(!R(t,"color"))return t;const n=/\$variable\((.+?)\)\$/.exec(t);if(!n)return t;let s;try{s=JSON.parse(n[1])}catch(e){return t}if(!s||"color"!==s.type)return t;const a=s.value?.name,i=s.value?.settings||{};if(!a)return t;if(r.has(a))return t;r.add(a);const l=e.getIn(["globalColors",a]);if(!l?.color)return r.delete(a),t;const u=(e,t=0)=>"number"==typeof e?e:t,p={hue:o.hue+u(i.hue),saturation:o.saturation+u(i.saturation),lightness:o.lightness+u(i.lightness),opacity:null!=o.opacity?o.opacity:"opacity"in i?u(i.opacity):null},d=B(e,l.color,r,p);if(r.delete(a),d.startsWith("#")&&(0!==p.hue||0!==p.saturation||0!==p.lightness||null!=p.opacity)){const e=(e,t)=>`calc(${e}${t>=0?" + ":" - "}${Math.abs(t)})`;return`hsl(from ${d} ${e("h",p.hue)} ${e("s",p.saturation)} ${e("l",p.lightness)}${null!=p.opacity&&100!==p.opacity?" / "+p.opacity/100:""})`}return d},j=({color:e,id:t=y(),lastUpdated:r=(new Date).toISOString(),status:o="active"})=>{(0,n.isEmpty)(t)?t=`gcid-${y()}`:t.startsWith("gcid-")||(t=`gcid-${t}`);return!(0,n.isEmpty)(r)&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z$/.test(r)||(r=(new Date).toISOString()),{type:"ADD_GLOBAL_COLOR",color:e,id:t,lastUpdated:r,status:o}},k=e=>({type:"DELETE_GLOBAL_COLOR",id:e}),$=(e,t)=>({type:"IMPORT_GLOBAL_COLORS",ids:e,data:t}),F=(e,t)=>({type:"UPDATE_GLOBAL_COLOR",id:e,color:t}),W=e=>({type:"UPDATE_GLOBAL_COLORS",palette:e}),x=(e,t,r)=>(!(0,n.isEmpty)(r)&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z$/.test(r)||(r=(new Date).toISOString()),{type:"UPDATE_GLOBAL_COLORS_USED_IN_POSTS",postId:e,globalColorIds:t,lastUpdated:r}),z=({moduleName:e,moduleLabel:t,presetType:r,version:o,created:n,updated:s})=>({type:"ADD_DEFAULT_MODULE_PRESET",moduleName:e,moduleLabel:t,presetType:r,version:o,created:n,updated:s}),Y=({moduleName:e,moduleLabel:t,moduleId:r,attrs:o,renderAttrs:n,styleAttrs:s,presetType:a,version:i,created:l,updated:u})=>({type:"ADD_NEW_MODULE_PRESET",moduleName:e,moduleLabel:t,moduleId:r,attrs:o,renderAttrs:n,styleAttrs:s,presetType:a,version:i,created:l,updated:u}),K=({moduleName:e,moduleLabel:t,moduleId:r,attrs:o,renderAttrs:n,styleAttrs:s,presetType:a,version:i,created:l,updated:u})=>({type:"ADD_NEW_MODULE_PRESET_FROM_CURRENT_STYLES",moduleName:e,moduleLabel:t,moduleId:r,attrs:o,renderAttrs:n,styleAttrs:s,presetType:a,version:i,created:l,updated:u}),J=(e,t)=>({type:"ASSIGN_PRESET_TO_DEFAULT",presetId:e,moduleName:t}),H=(e,t,r,o)=>({type:"CLONE_MODULE_PRESET",presetId:e,moduleName:t,moduleLabel:r,moduleId:o}),q=()=>({type:"CLOSE_CONFIRMATION_MODAL"}),Z=()=>({type:"CLOSE_OPTION_GROUP_CONFIRMATION_MODAL"}),Q=()=>({type:"CLOSE_PRESET_MODAL"}),X=(e,t)=>({type:"DELETE_MODULE_PRESET",presetId:e,moduleName:t}),ee=({presetType:e,presetSubType:t,presetId:r,attrName:o,attrValue:n,updated:s,attrsGroup:a})=>({type:"EDIT_PRESET_ATTRIBUTE",presetType:e,presetSubType:t,presetId:r,attrName:o,attrValue:n,updated:s,attrsGroup:a}),te=({confirmationAction:e,confirmationText:t,actionPayload:r,actionLabels:o})=>({type:"OPEN_CONFIRMATION_MODAL",confirmationAction:e,confirmationText:t,actionPayload:r,actionLabels:o}),re=({confirmationAction:e,confirmationText:t,actionPayload:r,actionLabels:o})=>({type:"OPEN_OPTION_GROUP_CONFIRMATION_MODAL",confirmationAction:e,confirmationText:t,actionPayload:r,actionLabels:o}),oe=()=>({type:"OPEN_PRESET_MODAL"}),ne=({groupId:e,visible:t,offsetTop:r,groupName:o,groupLabel:n})=>({type:"OPEN_OPTION_GROUP_PRESET_MODAL",groupId:e,visible:t,offsetTop:r,groupName:o,groupLabel:n}),se=({presetType:e,presetSubType:t,presetId:r,attrName:o,attrsGroup:n})=>({type:"REMOVE_PRESET_ATTRIBUTE",presetType:e,presetSubType:t,presetId:r,attrName:o,attrsGroup:n}),ae=({presetId:e,moduleName:t,name:r,updated:o})=>({type:"UPDATE_PRESET_NAME",presetId:e,moduleName:t,name:r,updated:o}),ie=({presetId:e,moduleName:t,attrs:r,styleAttrs:o,renderAttrs:n,moduleId:s,updated:a})=>({type:"UPDATE_PRESET_WITH_CURRENT_STYLES",presetId:e,moduleName:t,attrs:r,styleAttrs:o,renderAttrs:n,moduleId:s,updated:a}),le=(e,t)=>({type:"IMPORT_PRESETS",presets:e,isConversion:t}),ue=({moduleName:e,id:t,callback:r})=>({type:"ADD_PRESET_ATTRS_MAP_JOB",moduleName:e,id:t,callback:r}),pe=({moduleName:e,map:t})=>({type:"SET_PRESET_ATTRS_MAP",moduleName:e,map:t}),de=({presetType:e,presetSubType:t,presetId:r})=>({type:"SET_DEFAULT_PRESET_ON_SAVE",presetType:e,presetSubType:t,presetId:r}),ce=e=>({type:"SET_IS_GLOBAL_COLOR_EDITING",isEditing:e.isEditing}),ge=({groupId:e,groupName:t,enabled:r})=>({type:"SET_OPTION_GROUP_PRESET_EDIT_MODE",groupId:e,groupName:t,enabled:r}),me=(e={})=>({type:"UNSET_DEFAULT_PRESET_ON_SAVE",presetType:e.presetType,presetSubType:e.presetSubType}),fe=(e,t,r)=>({type:"END_PRESET_EDIT_SESSION",isRollback:e,presetType:t,unsavedPresetGroupName:r}),be=({presetType:e,presetId:t,moduleName:r})=>({type:"START_PRESET_EDIT_SESSION",presetType:e,presetId:t,moduleName:r}),Ee=e=>({type:"OVERRIDE_PRESET_DATA",data:e}),Ie=()=>({type:"SAVE_PRESET"}),ye=e=>({type:"END_SYNCING_PRESET",isError:e}),Oe=()=>({type:"START_SYNCING_PRESET"}),_e=({flag:e})=>({type:"TOGGLE_PRESET_SAVE_CONFIRMATION_DIALOG",flag:e}),Pe=e=>({type:"REMOVE_GLOBAL_COLOR_PREVIEW_VALUE",colorId:e}),Te=(e,t)=>({type:"SET_GLOBAL_COLOR_PREVIEW_VALUE",colorId:e,color:t}),ve=({moduleId:e,presetId:t,groupId:r,groupName:o,attrs:n,renderAttrs:s,styleAttrs:a,updated:i})=>({type:"UPDATE_OPTION_GROUP_PRESET_WITH_CURRENT_STYLES",moduleId:e,presetId:t,groupId:r,groupName:o,attrs:n,renderAttrs:s,styleAttrs:a,updated:i}),Se=({presetId:e,groupName:t,name:r,updated:o})=>({type:"UPDATE_OPTION_GROUP_PRESET_NAME",presetId:e,groupName:t,name:r,updated:o}),Ae=({presetId:e,groupId:t,groupName:r,groupLabel:o,moduleId:n})=>({type:"CLONE_OPTION_GROUP_PRESET",presetId:e,groupId:t,groupName:r,groupLabel:o,moduleId:n}),Ne=({moduleId:e,groupId:t,groupName:r,groupLabel:o,attrs:n,renderAttrs:s,styleAttrs:a,version:i,created:l,updated:u,moduleName:p,primaryAttrName:d})=>({type:"ADD_NEW_OPTION_GROUP_PRESET_FROM_CURRENT_STYLES",moduleId:e,groupId:t,groupName:r,groupLabel:o,attrs:n,renderAttrs:s,styleAttrs:a,version:i,created:l,updated:u,moduleName:p,primaryAttrName:d}),he=({presetId:e,groupName:t})=>({type:"DELETE_OPTION_GROUP_PRESET",presetId:e,groupName:t}),Ge=({groupName:e,groupLabel:t,attrs:r,renderAttrs:o,styleAttrs:n,version:s,created:a,updated:i,groupId:l,moduleId:u,moduleName:p,primaryAttrName:d})=>({type:"ADD_NEW_OPTION_GROUP_PRESET",groupName:e,groupLabel:t,attrs:r,renderAttrs:o,styleAttrs:n,version:s,created:a,updated:i,groupId:l,moduleId:u,moduleName:p,primaryAttrName:d}),Re=({presetId:e,groupName:t,groupId:r})=>({type:"ASSIGN_OPTION_GROUP_PRESET_TO_DEFAULT",presetId:e,groupName:t,groupId:r}),Le=({groupName:e,groupLabel:t,presetType:r,version:o,created:n,updated:s,moduleName:a,groupId:i,primaryAttrName:l})=>({type:"ADD_DEFAULT_OPTION_GROUP_PRESET",groupName:e,groupLabel:t,presetType:r,version:o,created:n,updated:s,moduleName:a,groupId:i,primaryAttrName:l}),De=()=>({type:"CLOSE_OPTION_GROUP_PRESET_MODAL"}),Ce=e=>({type:"CLOSE_OPTION_GROUP_PRESET_EDIT_MODE",groupId:e?.groupId,groupName:e?.groupName}),Me=({flag:e})=>({type:"TOGGLE_OPTION_GROUP_PRESET_SAVE_CONFIRMATION_DIALOG",flag:e}),we=({id:e,label:t,value:r,groupKey:o,order:n,status:s,allowedActions:a,lastUpdated:i})=>({type:"ADD_GLOBAL_VARIABLE",id:T(e,o),label:t,value:r,groupKey:o,status:s,order:n,allowedActions:a,lastUpdated:i}),Ue=({...e})=>({type:"ADD_GLOBAL_VARIABLES",...e}),Ve=({id:e,groupKey:t})=>({type:"DELETE_GLOBAL_VARIABLE",id:e,groupKey:t}),Be=({id:e,label:t,value:r,groupKey:o,status:n})=>({type:"UPDATE_GLOBAL_VARIABLE",id:e,label:t,value:r,groupKey:o,status:n}),je=e=>({type:"UPDATE_GLOBAL_VARIABLES",variables:e}),ke=({id:e,order:t,groupKey:r})=>({type:"UPDATE_GLOBAL_VARIABLE_ORDER",id:e,order:t,groupKey:r}),$e=()=>({type:"UPDATE_GLOBAL_VARIABLES_BACKUP"}),Fe=()=>({type:"RESET_GLOBAL_VARIABLES"}),We=({id:e,groupKey:t})=>({type:"RESTORE_GLOBAL_VARIABLE",id:e,groupKey:t}),xe=()=>({type:"SAVE_GLOBAL_VARIABLES"}),ze=e=>{switch(e.type){case"ADD_NEW_MODULE_PRESET_FROM_CURRENT_STYLES":case"UPDATE_PRESET_WITH_CURRENT_STYLES":case"ADD_NEW_OPTION_GROUP_PRESET_FROM_CURRENT_STYLES":case"UPDATE_OPTION_GROUP_PRESET_WITH_CURRENT_STYLES":{const{attrs:t,moduleId:r}=e,o=(0,d.flattenAttrs)(t),n=Object.keys(o);(0,l.dispatch)("divi/edit-post").removeModuleAttributes({id:r,attrNames:n});break}}},Ye=(e,t)=>{switch(e.type){case"ADD_NEW_OPTION_GROUP_PRESET":case"CLONE_OPTION_GROUP_PRESET":case"ADD_NEW_OPTION_GROUP_PRESET_FROM_CURRENT_STYLES":{const{groupName:r,groupId:o,moduleId:n}=e,s=t.getState().getIn(["presets"])?.asMutable({deep:!0}),{items:a}=s,i=a?.group?.[r]?.items,u=Object.keys(i).map((e=>i[e].created)),p=Math.max(...u),d=Object.keys(i).find((e=>i[e].created===p));(0,l.dispatch)("divi/edit-post").editGroupPresetAttr({id:n,attrName:o,value:{presetId:d,groupName:r}});break}}},Ke=(e,t)=>{switch(e.type){case"ADD_NEW_MODULE_PRESET_FROM_CURRENT_STYLES":case"ADD_NEW_MODULE_PRESET":case"CLONE_MODULE_PRESET":{const{moduleId:r,moduleName:o}=e,n=t.getState().getIn(["presets"])?.asMutable({deep:!0}),{items:s}=n,a=s?.module?.[o]?.items,i=Object.keys(a).map((e=>a[e].created)),u=Math.max(...i),p=Object.keys(a).find((e=>a[e].created===u));p&&(0,l.dispatch)("divi/global-data").startPresetEditSession({presetType:"module",moduleName:o,presetId:p}),(0,l.dispatch)("divi/edit-post").editModuleAttribute({id:r,attrName:"modulePreset",value:p});break}}},Je=e=>{switch(e.type){case"CLOSE_PRESET_MODAL":(0,l.dispatch)("divi/global-data").endPresetEditSession(!0,"module");break;case"CLOSE_OPTION_GROUP_PRESET_EDIT_MODE":(0,l.dispatch)("divi/global-data").endPresetEditSession(!0,"group")}},He=(e,t)=>{const r=t.getState().getIn(["presets"]).asMutable({deep:!0}),{optionGroupPreset:o}=r,{groupId:n,groupName:s}=o||{},a=r?.isActive;switch(e.type){case"OPEN_PRESET_MODAL":a&&o?.isPresetActive&&(0,l.dispatch)("divi/global-data").closeOptionGroupPresetEditMode({groupId:n,groupName:s}),(0,l.dispatch)("divi/global-data").startPresetEditSession({presetType:"module"});break;case"SET_OPTION_GROUP_PRESET_EDIT_MODE":e?.lastActiveGroupId&&n!==e?.lastActiveGroupId&&s!==e?.lastActiveGroupName&&(0,l.dispatch)("divi/global-data").endPresetEditSession(!0,"group",e?.lastActiveGroupName),(0,l.dispatch)("divi/global-data").startPresetEditSession({presetType:"group"})}};var qe=window.divi.rest;function Ze(e,t="expected a function, instead received "+typeof e){if("function"!=typeof e)throw new TypeError(t)}var Qe=e=>Array.isArray(e)?e:[e];function Xe(e){const t=Array.isArray(e[0])?e[0]:e;return function(e,t="expected all items to be functions, instead received the following types: "){if(!e.every((e=>"function"==typeof e))){const r=e.map((e=>"function"==typeof e?`function ${e.name||"unnamed"}()`:typeof e)).join(", ");throw new TypeError(`${t}[${r}]`)}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function et(e,t){const r=[],{length:o}=e;for(let n=0;n<o;n++)r.push(e[n].apply(null,t));return r}Symbol(),Object.getPrototypeOf({});var tt="undefined"!=typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}};function rt(e,t={}){let r={s:0,v:void 0,o:null,p:null};const{resultEqualityCheck:o}=t;let n,s=0;function a(){let t=r;const{length:a}=arguments;for(let e=0,r=a;e<r;e++){const r=arguments[e];if("function"==typeof r||"object"==typeof r&&null!==r){let e=t.o;null===e&&(t.o=e=new WeakMap);const o=e.get(r);void 0===o?(t={s:0,v:void 0,o:null,p:null},e.set(r,t)):t=o}else{let e=t.p;null===e&&(t.p=e=new Map);const o=e.get(r);void 0===o?(t={s:0,v:void 0,o:null,p:null},e.set(r,t)):t=o}}const i=t;let l;if(1===t.s?l=t.v:(l=e.apply(null,arguments),s++),i.s=1,o){const e=n?.deref?.()??n;null!=e&&o(e,l)&&(l=e,0!==s&&s--);n="object"==typeof l&&null!==l||"function"==typeof l?new tt(l):l}return i.v=l,l}return a.clearCache=()=>{r={s:0,v:void 0,o:null,p:null},a.resetResultsCount()},a.resultsCount=()=>s,a.resetResultsCount=()=>{s=0},a}function ot(e,...t){const r="function"==typeof e?{memoize:e,memoizeOptions:t}:e,o=(...e)=>{let t,o=0,n=0,s={},a=e.pop();"object"==typeof a&&(s=a,a=e.pop()),Ze(a,`createSelector expects an output function after the inputs, but received: [${typeof a}]`);const i={...r,...s},{memoize:l,memoizeOptions:u=[],argsMemoize:p=rt,argsMemoizeOptions:d=[],devModeChecks:c={}}=i,g=Qe(u),m=Qe(d),f=Xe(e),b=l((function(){return o++,a.apply(null,arguments)}),...g);const E=p((function(){n++;const e=et(f,arguments);return t=b.apply(null,e),t}),...m);return Object.assign(E,{resultFunc:a,memoizedResultFunc:b,dependencies:f,dependencyRecomputations:()=>n,resetDependencyRecomputations:()=>{n=0},lastResult:()=>t,recomputations:()=>o,resetRecomputations:()=>{o=0},memoize:l,argsMemoize:p})};return Object.assign(o,{withTypes:()=>o}),o}var nt=ot(rt),st=Object.assign(((e,t=nt)=>{!function(e,t="expected an object, instead received "+typeof e){if("object"!=typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);const r=Object.keys(e);return t(r.map((t=>e[t])),((...e)=>e.reduce(((e,t,o)=>(e[r[o]]=t,e)),{})))}),{withTypes:()=>st});const at=nt([e=>e.getIn(["presets"])],(e=>e.getIn(["confirmationModal"]))),it=nt([e=>e.getIn(["presets"])],(e=>e.getIn(["optionGroupConfirmationModal"]))),lt=(e,t)=>e.getIn(["globalColors",t]);var ut=window.vendor.wp.i18n;const pt=nt([e=>e],(e=>{const t=e.getIn(["globalColors"],{}),r=["gcid-primary-color","gcid-secondary-color","gcid-heading-color","gcid-body-color"],o=[],n=[];Object.keys(t).forEach((e=>{const s=t[e];if("active"===s?.status)if(r.includes(e))o.push(s?.id||e);else{const t=Number(s?.order),r=Number.isFinite(t)?t:999;n.push({id:s?.id||e,order:r})}})),n.sort(((e,t)=>e.order-t.order));const s=[...o,...n.map((e=>e.id))];return{id:"global",title:(0,ut.__)("Global","et_builder"),colors:s,configurable:!0,expandable:!1,priority:2,requiresColorUpdateConfirmation:!0,saveChangedColorOnSubmit:!0,addColor:{store:"divi/global-data",actionType:"dispatch",actionName:"addGlobalColor",params:["color"]},deleteColor:{store:"divi/global-data",actionType:"dispatch",actionName:"deleteGlobalColor",params:["colorId"]},updateColor:{store:"divi/global-data",actionType:"dispatch",actionName:"updateGlobalColor",params:["colorId","color"]},getColorValue:{store:"divi/global-data",actionType:"select",actionName:"getGlobalColorValue",params:["colorId","activeOnly"]},getRenderableValue:{store:"divi/global-data",actionType:"select",actionName:"getRenderableValue",params:["colorId","color"]},getGlobalColorLabel:{store:"divi/global-data",actionType:"select",actionName:"getGlobalColorLabel",params:["colorId"]},isGlobalColorRemovable:{store:"divi/global-data",actionType:"select",actionName:"isGlobalColorRemovable",params:["colorId"]},getColorIdFromValue:S,removePreviewColor:{store:"divi/global-data",actionType:"dispatch",actionName:"removeGlobalColorPreviewValue",params:["colorId"]},setPreviewColor:{store:"divi/global-data",actionType:"dispatch",actionName:"setGlobalColorPreviewValue",params:["colorId","color"]}}})),dt=e=>e.getIn(["globalColors"],{}),ct=e=>e.getIn(["legacyGlobalColors"],{}),gt=e=>e.getIn(["previewGlobalColors"],{}),mt=nt([e=>e,(e,t)=>t],((e,t)=>{const r=["active","inactive","temporary"].filter((e=>e!==t));return e.getIn(["globalColors"]).without((e=>r.includes(e.status)))}));var ft=r(53316),bt=r.n(ft);const Et=nt([e=>e.getIn(["globalColors"]),(e,t)=>t],bt()(((e,t)=>{const r=(0,s.asMutable)(e,{deep:!0}),o=(0,n.pickBy)(r,((e,r)=>(0,n.includes)(t,r)));return Object.entries(o).map((([e,t])=>[e,{color:t.color,status:t.status}]))}))),It=nt([e=>e.getIn(["globalVariables"]),(e,t)=>t],bt()(((e,t)=>t.map((t=>{const r=Object.keys(e).find((r=>{const o=e[r];return t in o}));return r?(0,n.omit)({...e[r][t],type:r},["allowedActions"]):null}))))),yt=nt([e=>e,(e,t)=>t,(e,t,r)=>r],((e,t,r=!1)=>{const o=e.getIn(["globalColors",t]);return!o||r&&"active"!==o.status?"":o.color})),Ot=nt([e=>e.getIn(["presets","items"]),(e,t)=>t],((e,{presetSubType:t,presetType:r="module"})=>{const o=e?.getIn([r,t,"default"]);return o})),_t=nt([e=>e.getIn(["presets","items"]),(e,t)=>t,(e,t)=>Ot(e,{presetSubType:t.presetSubType,presetType:t.presetType})],((e,{presetSubType:t,presetType:r="module"},o)=>{const n=e?.getIn([r,t,"items",o]);return n})),Pt=nt([e=>e.getIn(["presets","items"]),(e,t)=>t,(e,t)=>_t(e,{presetSubType:t.moduleName})],((e,{moduleName:t,id:r,useDefaultFallback:o,presetType:n="module"},s)=>o?e.getIn([n,t,"items",r])??s:e.getIn([n,t,"items",r])),{memoizeOptions:{resultEqualityCheck:n.isEqual}}),Tt={},vt=(e,t)=>{const{presets:r}=t;return(0,n.forEach)(Tt,((e,t)=>{delete Tt[t]})),(0,n.forEach)(r,((t,r)=>{const o=Pt(e,t);o&&(Tt[r]=o)})),Tt},St=nt([e=>e.getIn(["presets","items"]),(e,t)=>t],((e,{moduleName:t,presetType:r="module"})=>{const o=e?.getIn([r,t,"items"]);return o})),At=nt([e=>e.getIn(["presets","items"]),(e,t)=>t],((e,{moduleName:t,id:r,attrName:o,presetType:n="module"})=>{const s=e?.getIn([n,t,"items",r,"attrs"]);return s?.getIn(o.split("."))})),Nt=(e,t,r)=>"active"===e.getIn(["globalColors",t,"status"],"")?`var(--${t})`:e.getIn(["globalColors",t,"color"],r),ht=(e,t)=>{const r=e.getIn(["globalColors",t,"color"],"");return e.getIn(["globalColors",t,"label"],r)||r},Gt=(e,t)=>"customizer"!==e.getIn(["globalColors",t,"folder"],""),Rt=nt([e=>e.getIn(["presets","confirmationModal"])],(e=>e.getIn(["isVisible"]))),Lt=nt([e=>e.getIn(["presets","optionGroupConfirmationModal"])],(e=>e.getIn(["isVisible"]))),Dt=(e,t)=>{const r=S({value:t});return(0,n.isEmpty)(r)?null:e.getIn(["globalColors",r])},Ct=(e,t)=>"active"===e.getIn(["globalColors",t,"status"]),Mt=e=>e.getIn(["isGlobalColorEditing"],!1),wt=nt([e=>e.getIn(["presets"])],(e=>e.getIn(["isActive"]))),Ut=nt([e=>e.getIn(["presets"])],(e=>e.getIn(["optionGroupPresetModal","isOptionGroupModalOpen"]))),Vt=nt([e=>e.getIn(["presets","attrsMapping"])],(e=>e?.getIn(["jobs"]))),Bt=nt([e=>e.getIn(["presets","attrsMapping","maps"]),(e,t)=>t],((e,t)=>e?.getIn([t]))),jt=nt([e=>e.getIn(["presets","defaultOnSave"]),(e,t)=>t],((e,t)=>{const r=e?.getIn([t.presetType,t.presetSubType]);return r})),kt=nt([e=>e.getIn(["presets"])],(e=>e.getIn(["isSyncing"]))),$t=nt([e=>e.getIn(["presets","items"]),(e,t)=>t],((e,t)=>{const r=t?.presetType??"module";return e?.getIn([r])})),Ft=nt([e=>e.getIn(["presets"])],(e=>!!e.getIn(["showPresetSaveConfirmationDialog"]))),Wt=e=>e.getIn(["previewGlobalColors"],{}),xt=nt([e=>e.getIn(["previewGlobalColors"]),e=>e.getIn(["globalColors"]),(e,t)=>t,e=>e],((e,t,r,o)=>{if(r.startsWith("var(--")&&(r=S({value:r})),(0,n.isEmpty)(r))return null;const s=e.getIn([r]),a=t.getIn([r]);let i=null;return s?.color?i=s.color:a?.color&&(i=a.color),i?R(i,"color")?B(o,i):i:null})),zt=(e,t)=>(t?.globalColorIds??[]).reduce(((t,r)=>({...t,[r]:xt(e,r)})),{}),Yt=nt([e=>e.getIn(["presets"])],(e=>{const t=e?.getIn(["optionGroupPresetModal"]);return t})),Kt=nt([e=>e.getIn(["presets","items"]),(e,t)=>t,(e,t)=>_t(e,{presetSubType:t.groupName,presetType:"group"})],((e,{groupName:t,id:r,useDefaultFallback:o},n)=>{const s=e.getIn(["group",t,"items",r]);return o?s??n:s})),Jt=nt([e=>e,(e,t)=>t],((e,t)=>{const{presets:r}=t,o={};return(0,n.forEach)(r,((t,r)=>{const n=Kt(e,t);n&&(o[r]=n)})),o}),{memoizeOptions:{resultEqualityCheck:n.isEqual}}),Ht=nt([e=>e.getIn(["presets","items"]),(e,t)=>t],((e,{groupName:t})=>e.getIn(["group",t,"items"]))),qt=nt([e=>e.getIn(["presets"]),(e,t)=>t,(e,t,r)=>r],((e,t,r)=>{const o=e.getIn(["optionGroupPreset","isPresetActive"]),n=e.getIn(["optionGroupPreset","groupId"]),s=e.getIn(["optionGroupPreset","groupName"]);return o&&n===t&&s===r})),Zt=nt([e=>e.getIn(["presets"])],(e=>{const t=e?.getIn(["optionGroupPreset"]);return t})),Qt=e=>{const t=e.getIn(["presets","items","group"]),r=[];return(0,n.forEach)(t,((e,t)=>{const o=e.getIn(["default"]);if(!o)return;const s=e.getIn(["items",o]);(0,n.isEmpty)(s?.attrs)||r.push(t)})),r},Xt=nt([e=>e.getIn(["presets"])],(e=>!!e.getIn(["optionGroupPreset","showSaveConfirmationDialog"]))),er=(e,t,r=!1)=>{const o=e.getIn(["globalVariables"]);if((0,n.isEmpty)(o))return null;const s=Object.keys(o).find((e=>{const r=o[e];return t in r})),a=s?o[s][t]:null;if(!r||!a)return a;const i=(t,r=new Set)=>{if(r.has(t.id))return t;r.add(t.id);const{value:o}=t;if("string"==typeof o&&o.includes("$variable(")){const n=((e,t)=>{if("string"!=typeof e||!e.includes("$variable("))return!1;const r=/\$variable\((.+?)\)\$/.exec(e);if(r)try{return JSON.parse(r[1])}catch(r){return console.warn("Failed to parse $variable reference in global variable:",t||e,r),!1}return!1})(o,t.id);if(n){const s=n?.value?.name;if(s&&s!==t.id){const a=er(e,s,!1);if(a){if("color"===n.type){const r=B(e,o);return t.merge({value:r})}return i(a,r)}}}}return t};return i(a)},tr=(e,t)=>{const r=e.getIn(["globalVariablesBackup"]);return(0,n.isEmpty)(r)?null:r[t]},rr=e=>e.getIn(["globalVariables"]),or=nt([e=>e],(e=>{const t=mt(e,"active"),r={};return Object.keys(t).forEach((o=>{const n=t[o];if(n&&"string"==typeof n?.color){const t=xt(e,o);r[o]=t||n.color}})),r})),nr=(e,t)=>{const r=t.getState(),o=dt(r);(0,qe.loggedFetch)({method:"POST",restRoute:"/divi/v1/global-data/global-colors",data:{global_colors:o}},!0).catch((e=>{console.log(e)}))},sr=(e,t)=>{const r=Object.keys(e??{}).reduce(((r,o)=>(r[o]=(({data:e,presetType:t,itemModifier:r})=>Object.keys(e??{}).reduce(((o,n)=>{const s=e[n],a=Object.values(s?.items??{}),i={default:s?.default,items:a};return r?o.concat(r(i,t)):o.concat(i)}),[]))({data:e[o],presetType:o,itemModifier:t}),r)),{});return r};var ar=window.divi.window;var ir=window.vendor.React,lr=r.n(ir);const ur=({error:e,onRetry:t,onDownloadBackup:r})=>{const o=()=>{const e=(0,ir.createElement)("p",null,(0,ut.__)("An error has occurred while saving the Global Presets settings. Various problems can cause a save to fail, such as a lack of server resources, firewall blockages or plugin conflicts or server misconfiguration. You can try saving again by clicking Try Again, or you can download a backup of your unsaved defaults by clicking Download Backup. A backup can be helpful when contacting our Support Team.","et_builder"));(0,l.dispatch)("divi/modal-library").open({name:"divi/alert",centered:!0,dimension:{width:320,height:400},attributes:{title:(0,ut.__)("Save of Global Presets Has Failed","et_builder"),content:e,footerButtons:[{name:"primary",label:(0,ut.__)("Try Again","et_builder"),onClick:e=>{e.preventDefault(),t()}},{name:"secondary",label:(0,ut.__)("Download Backup","et_builder"),onClick:e=>{e.preventDefault(),r()}}],centered:!0}})};e instanceof Response?(async e=>{const t=await e.text();return JSON.parse(t)})(e).then((e=>{console.error(e.message),o()})).catch((()=>{console.error(e),o()})):e instanceof Error?(console.error(e?.message),"AbortError"!==e.name&&o()):(console.error(e),o())},pr=["attrs","styleAttrs","renderAttrs"],dr=({schema:e,presetType:t,defaultOnSave:r})=>(r&&(e=(({schema:e,presetType:t,defaultOnSave:r})=>{const o=r?.[t];if(o){const t=e.items.find((e=>{switch(e.type){case"module":return e.id===o?.[e.moduleName];case"group":return e.id===o?.[e.groupName];default:return!1}}));t&&(e={...e,default:t.id})}else e.default&&e.items.length&&(e={...e,default:e.items[0].id});return e})({schema:e,presetType:t,defaultOnSave:r})),e=(({schema:e})=>{const t=[...e.items];return{...e,items:t.map((e=>{let t={...e};return pr.forEach((r=>{switch(r){case"attrs":case"styleAttrs":case"renderAttrs":if((0,n.has)(e,r)){const o=(0,d.removeEmptyObjectRecursive)(e[r]);(0,n.isEmpty)(o)?delete t[r]:(0,n.isEqual)(o,e[r])||(t={...t,[r]:o})}}})),t}))}})({schema:e}));let cr;const gr=(e,t)=>{const r=()=>{t.getState().getIn(["presets","isSyncingError"])&&(0,l.dispatch)("divi/modal-library").close({name:"divi/alert"})},o=()=>{cr?.abort&&cr.abort()},s=({isConversion:r=!1,endEditMode:s=!0,presetsType:a=""})=>{o(),(0,l.dispatch)("divi/global-data").startSyncingPreset(),cr=new AbortController;const i=t.getState().getIn(["presets","items"])?.asMutable({deep:!0}),u=t.getState().getIn(["presets","defaultOnSave"]),p=sr(i,((e,t)=>dr({schema:e,presetType:t,defaultOnSave:u})));(0,qe.fetch)({restRoute:"/divi/v1/global-data/global-preset/sync",method:"POST",data:{presets:p,converted:r},signal:cr.signal}).then((e=>{if((0,l.dispatch)("divi/global-data").endSyncingPreset(!1),u&&(0,l.dispatch)("divi/global-data").unsetDefaultPresetOnSave(),(0,n.isEqual)(i,e)||(0,l.dispatch)("divi/global-data").overridePresetData(e),(0,l.dispatch)("divi/global-data").endPresetEditSession(!1,a),(0,l.dispatch)("divi/global-data").closeConfirmationModal(),(0,l.dispatch)("divi/global-data").closeOptionGroupConfirmationModal(),s)(0,l.dispatch)("divi/global-data").closePresetModal(),(0,l.dispatch)("divi/global-data").closeOptionGroupPresetEditMode();else switch(a){case"module":case"group":(0,l.dispatch)("divi/global-data").startPresetEditSession({presetType:a});break;default:(0,l.dispatch)("divi/global-data").startPresetEditSession()}})).catch((r=>{(0,l.dispatch)("divi/global-data").endSyncingPreset(!0),ur({error:r,onRetry:()=>{gr(e,t)},onDownloadBackup:()=>{(e=>{const t=JSON.stringify(e),r=new Blob([t],{type:"application/json"}),o=URL.createObjectURL(r),n=ar.topWindow.document.createElement("a");n.style.display="none",n.download="global-defaults-backup.json",n.href=o,ar.topWindow.document.body.appendChild(n),n.click(),setTimeout((()=>{URL.revokeObjectURL(o),n.parentNode.removeChild(n)}),500)})(i)}})}))};switch(e.type){case"ADD_NEW_MODULE_PRESET_FROM_CURRENT_STYLES":case"ADD_NEW_MODULE_PRESET":case"CLONE_MODULE_PRESET":r(),(0,l.dispatch)("divi/global-data").openPresetModal(),s({endEditMode:!1,presetsType:"module"});break;case"ASSIGN_OPTION_GROUP_PRESET_TO_DEFAULT":r(),(0,l.dispatch)("divi/global-data").closeOptionGroupPresetModal(),s({});break;case"ADD_NEW_OPTION_GROUP_PRESET_FROM_CURRENT_STYLES":case"ADD_NEW_OPTION_GROUP_PRESET":case"CLONE_OPTION_GROUP_PRESET":r(),(0,l.dispatch)("divi/global-data").setOptionGroupPresetEditMode({groupId:e.groupId,groupName:e.groupName,enabled:!0}),s({endEditMode:!1,presetsType:"group"});break;case"ASSIGN_PRESET_TO_DEFAULT":case"DELETE_MODULE_PRESET":case"DELETE_OPTION_GROUP_PRESET":case"SAVE_PRESET":case"UPDATE_PRESET_WITH_CURRENT_STYLES":case"UPDATE_OPTION_GROUP_PRESET_WITH_CURRENT_STYLES":r(),s({});break;case"IMPORT_PRESETS":r(),s({isConversion:e.isConversion});break;case"CLOSE_PRESET_MODAL":r(),o()}},mr={ADD_NEW_MODULE_PRESET_FROM_CURRENT_STYLES:[Ke,ze,gr],ADD_NEW_MODULE_PRESET:[Ke,gr],ASSIGN_PRESET_TO_DEFAULT:[gr],CLONE_MODULE_PRESET:[Ke,gr],CLOSE_PRESET_MODAL:[Je,gr],DELETE_MODULE_PRESET:[gr],OPEN_PRESET_MODAL:[He],UPDATE_PRESET_WITH_CURRENT_STYLES:[ze,gr],ADD_NEW_OPTION_GROUP_PRESET_FROM_CURRENT_STYLES:[Ye,ze,gr],ADD_NEW_OPTION_GROUP_PRESET:[Ye,gr],ASSIGN_OPTION_GROUP_PRESET_TO_DEFAULT:[gr],CLONE_OPTION_GROUP_PRESET:[Ye,gr],CLOSE_OPTION_GROUP_PRESET_EDIT_MODE:[Je,gr],DELETE_OPTION_GROUP_PRESET:[gr],SET_OPTION_GROUP_PRESET_EDIT_MODE:[He],UPDATE_OPTION_GROUP_PRESET_WITH_CURRENT_STYLES:[ze,gr],SAVE_PRESET:[gr],IMPORT_PRESETS:[e=>{switch(e.type){case"IMPORT_PRESETS":{const e=(0,l.select)("divi/edit-post").getContent()?.asMutable({deep:!0}),t=(0,d.populateUsedPresets)(e),r=(0,d.populateUsedGroupPresets)(e);(0,l.dispatch)("divi/edit-post").updateUsedPresets({presetType:"module",presets:t}),(0,l.dispatch)("divi/edit-post").updateUsedPresets({presetType:"group",presets:r});break}}},gr],ADD_GLOBAL_COLOR:[nr],DELETE_GLOBAL_COLOR:[nr,()=>{const e=(0,l.select)("divi/global-data").getGlobalColors();(0,l.dispatch)("divi/edit-post").syncModuleGlobalColors(e)}],IMPORT_GLOBAL_COLORS:[nr],UPDATE_GLOBAL_COLOR:[nr],UPDATE_GLOBAL_COLORS_USED_IN_POSTS:[nr],UPDATE_GLOBAL_COLORS:[nr],SAVE_GLOBAL_VARIABLES:[(e,t)=>{const r=t.getState(),o=rr(r);(0,qe.loggedFetch)({method:"POST",restRoute:"/divi/v1/global-data/global-variables",data:{global_variables:o}},!0).catch((e=>{console.log(e)}))}]},fr={SET_OPTION_GROUP_PRESET_EDIT_MODE:[()=>e=>t=>{const r=(0,l.select)("divi/global-data").getOptionGroupPresetEditMode(),o=r?.groupId,n=r?.groupName;t.lastActiveGroupId=o,t.lastActiveGroupName=n;return e(t)}]},br=(e,t)=>{switch(t.type){case"ADD_GLOBAL_COLOR":return((e,t,r,o,s="active")=>{if((0,n.isEmpty)(t)||h(t))return e;const a={id:r,color:t,status:s,lastUpdated:o,usedInPosts:[]};return e.setIn(["globalColors",a.id],{...a})})(e,t.color,t.id,t.lastUpdated,t.status);case"DELETE_GLOBAL_COLOR":return((e,t)=>{const r=e.getIn(["globalColors",t]);return r?e.setIn(["globalColors",t],{...r,lastUpdated:(new Date).toISOString(),status:"inactive"}):e})(e,t.id);case"IMPORT_GLOBAL_COLORS":return((e,t,r)=>{const o=e.getIn(["globalColors"]),s={};return(0,n.forEach)(t,(e=>{o[e]||(s[e]=r[e])})),(0,n.isEmpty)(s)?e:e.setIn(["globalColors"],{...o,...s})})(e,t.ids,t.data);case"UPDATE_GLOBAL_COLOR":return((e,t,r)=>{const o=e.getIn(["globalColors",t]);return!o||(0,n.isEmpty)(r)||h(r)?e:e.setIn(["globalColors",t],{...o,lastUpdated:(new Date).toISOString(),color:r})})(e,t.id,t.color);case"UPDATE_GLOBAL_COLORS":return((e,t)=>{const r=e.getIn(["globalColors"]);return(0,n.isEqual)(r,t)?e:e.setIn(["globalColors"],{...t})})(e,t.palette);case"UPDATE_GLOBAL_COLORS_USED_IN_POSTS":return((e,t,r,o)=>{let s=e.getIn(["globalColors"]);return r.forEach((r=>{const n=e.getIn(["globalColors",r,"usedInPosts"])?.asMutable()??[];n?.includes(t)||(s=s.setIn([r,"usedInPosts"],[...n,t]).setIn([r,"lastUpdated"],o))})),(0,n.forEach)(s,((e,a)=>{if((0,n.isObject)(e)){const n=e.getIn(["usedInPosts"])?.asMutable()??[];n.includes(t)&&!r.includes(a)&&(s=s.setIn([a,"usedInPosts"],n.filter((e=>e!==t))).setIn([a,"lastUpdated"],o))}})),e.setIn(["globalColors"],{...s})})(e,t.postId,t.globalColorIds,t.lastUpdated);case"SET_IS_GLOBAL_COLOR_EDITING":return((e,t)=>e.set("isGlobalColorEditing",t.isEditing))(e,t);case"REMOVE_GLOBAL_COLOR_PREVIEW_VALUE":return((e,t)=>e.setIn(["previewGlobalColors"],e.previewGlobalColors.without(t)))(e,t.colorId);case"SET_GLOBAL_COLOR_PREVIEW_VALUE":return((e,t,r)=>e.setIn(["previewGlobalColors",t],{colorId:t,color:r}))(e,t.colorId,t.color);case"OPEN_PRESET_MODAL":return(e=>e.setIn(["presets","isActive"],!0))(e);case"CLOSE_PRESET_MODAL":return(e=>e.setIn(["presets","isActive"],!1))(e);case"EDIT_PRESET_ATTRIBUTE":return e.getIn(["presets","isSyncing"])?e:((e,{presetType:t,presetSubType:r,presetId:o,attrName:n,attrValue:s,updated:a,attrsGroup:i})=>{const l=["presets","items",t,r,"items",(0,d.getSelectedPresetOrDefault)(o,e.getIn(["presets","items",t,r,"default"]))];return Array.isArray(i)&&0<i.length&&(i.forEach((t=>{let r=l.concat(t);n&&(r=r.concat(n.split("."))),e=e.setIn(r,s)})),e=e.setIn(l.concat("updated"),a)),e})(e,{presetType:t.presetType,presetSubType:t.presetSubType,presetId:t.presetId,attrName:t.attrName,attrValue:t.attrValue,updated:t.updated,attrsGroup:t.attrsGroup});case"REMOVE_PRESET_ATTRIBUTE":return((e,{presetType:t,presetSubType:r,presetId:o,attrName:s,attrsGroup:a})=>{const i=["presets","items",t,r,"items",(0,d.getSelectedPresetOrDefault)(o,e.getIn(["presets","items",t,r,"default"]))],l=s.split("."),u=l[0];return a.forEach((t=>{const r=i.concat(t),o=r.concat(l),s=(0,n.slice)(o,0,o.length-1),a=e.getIn(s);if(!(0,n.isEmpty)(a)){const t=(0,n.last)(o),i=(e=e.setIn(s,a.without(t))).getIn(r),l=e.getIn(r.concat(u)),p=(0,d.removeEmptyObjectRecursive)(l?.asMutable({deep:!0}));(0,n.isEmpty)(p)?e=e.setIn(r,i.without(u)):(0,n.isEqual)(p,l?.asMutable({deep:!0}))||(e=e.setIn(r.concat(u),p))}})),e})(e,{presetType:t.presetType,presetSubType:t.presetSubType,presetId:t.presetId,attrName:t.attrName,attrsGroup:t.attrsGroup});case"ASSIGN_PRESET_TO_DEFAULT":return e.getIn(["presets","isSyncing"])?e:((e,t,r)=>{const o=["presets","items","module",r,"default"];return e.setIn(o,t)})(e,t.presetId,t.moduleName);case"ASSIGN_OPTION_GROUP_PRESET_TO_DEFAULT":return e.getIn(["presets","isSyncing"])?e:((e,{presetId:t,groupName:r})=>{const o=L({presetId:t,groupName:r,state:e});if(o===e.getIn(["presets","items","group",r,"default"]))return e;const n=e.getIn(["presets","items","group",r,"items"])?.getIn([o]);return n?e.setIn(["presets","items","group",r,"default"],t):e})(e,{presetId:t.presetId,groupName:t.groupName,groupId:t.groupId});case"DELETE_MODULE_PRESET":return e.getIn(["presets","isSyncing"])?e:((e,t,r)=>{const o=e.getIn(["presets","items","module",r,"default"]),n=e.getIn(["presets","items","module",r,"items"]).without(t);let s=o;const a=Object.keys(n).length??0;if(o===t||1===a){const e=Object.values(n).sort(((e,t)=>e.created-t.created)).reduce(((e,t)=>({...e,[t.id]:t})),{});s=Object.keys(e)[0]??null}return e.setIn(["presets","items","module",r],{items:n,default:s})})(e,t.presetId,t.moduleName);case"DELETE_OPTION_GROUP_PRESET":return e.getIn(["presets","isSyncing"])?e:((e,{presetId:t,groupName:r})=>{const o=L({presetId:t,groupName:r,state:e}),n=e.getIn(["presets","items","group",r,"items"]),s=n?.getIn([o]);if(!s)return e;const a=e.getIn(["presets","items","group",r,"default"]),i=n.without(t);let l=a;1===(Object.keys(i).length??0)?l=Object.keys(i)[0]??null:a===t&&(l=Object.values(i).sort(((e,t)=>(e.created??0)-(t.created??0)))[0]?.id??null);return e.setIn(["presets","items","group",r],{items:i,default:l})})(e,{presetId:t.presetId,groupName:t.groupName});case"CLONE_MODULE_PRESET":return e.getIn(["presets","isSyncing"])?e:((e,t,r,o)=>{const n=D({id:t,moduleName:r,state:e}),s=e.getIn(["presets","items","module",r,"items"])?.asMutable({deep:!0})??{},a=s[n],{id:i,name:l}=O(Object.values(s??{}).map((e=>e.name)),o),u={...a,id:i,name:l,created:Date.now(),updated:Date.now()};return e.setIn(["presets","items","module",r,"items",i],u)})(e,t.presetId,t.moduleName,t.moduleLabel);case"CLONE_OPTION_GROUP_PRESET":return e.getIn(["presets","isSyncing"])?e:((e,{presetId:t,groupName:r,groupLabel:o})=>{const n=L({presetId:t,groupName:r,state:e}),s=e.getIn(["presets","items","group",r,"items"])?.getIn([n]);if(!s)return e;const a=e.getIn(["presets","items","group",r,"items"])?.asMutable({deep:!0}),i=Object.values(a??{}).map((e=>e.name)),{id:l,name:u}=O(i,o),p={...s,id:l,name:u,created:Date.now(),updated:Date.now()};return e.setIn(["presets","items","group",r,"items",l],p)})(e,{presetId:t.presetId,groupId:t.groupId,groupName:t.groupName,groupLabel:t.groupLabel,moduleId:t.moduleId});case"UPDATE_PRESET_WITH_CURRENT_STYLES":return e.getIn(["presets","isSyncing"])?e:((e,{presetId:t,moduleName:r,attrs:o,styleAttrs:s,renderAttrs:a,updated:i})=>{const l=D({id:t,moduleName:r,state:e}),u=e.getIn(["presets","items","module",r,"items"])?.getIn([l]),p=u?.getIn(["attrs"])?.asMutable({deep:!0})??{},d=(0,n.merge)({},p,o);(0,n.isEmpty)(d)||(e=e.setIn(["presets","items","module",r,"items",l,"attrs"],d));const c=u.getIn(["styleAttrs"])?.asMutable({deep:!0})??{},g=(0,n.merge)({},c,s);(0,n.isEmpty)(g)||(e=e.setIn(["presets","items","module",r,"items",l,"styleAttrs"],g));const m=u.getIn(["renderAttrs"])?.asMutable({deep:!0})??{},f=(0,n.merge)({},m,a);return(0,n.isEmpty)(f)||(e=e.setIn(["presets","items","module",r,"items",l,"renderAttrs"],f)),e.setIn(["presets","items","module",r,"items",l,"updated"],i)})(e,{presetId:t.presetId,moduleName:t.moduleName,attrs:t.attrs,styleAttrs:t.styleAttrs,renderAttrs:t.renderAttrs,updated:t.updated,moduleId:t.moduleId});case"OPEN_CONFIRMATION_MODAL":return((e,{confirmationAction:t,confirmationText:r,actionPayload:o,actionLabels:n})=>e.setIn(["presets","confirmationModal"],{isVisible:!0,confirmationAction:t,confirmationText:r,actionPayload:o,actionLabels:n}))(e,{confirmationAction:t.confirmationAction,confirmationText:t.confirmationText,actionPayload:t.actionPayload,actionLabels:t.actionLabels});case"OPEN_OPTION_GROUP_CONFIRMATION_MODAL":return((e,{confirmationAction:t,confirmationText:r,actionPayload:o,actionLabels:n})=>e.setIn(["presets","optionGroupConfirmationModal"],{isVisible:!0,confirmationAction:t,confirmationText:r,actionPayload:o,actionLabels:n}))(e,{confirmationAction:t.confirmationAction,confirmationText:t.confirmationText,actionPayload:t.actionPayload,actionLabels:t.actionLabels});case"OPEN_OPTION_GROUP_PRESET_MODAL":return((e,{groupId:t,groupName:r,groupLabel:o,visible:n,offsetTop:s})=>e.setIn(["presets","optionGroupPresetModal"],{groupId:t,groupName:r,groupLabel:o,isOptionGroupModalOpen:n,offsetTop:s}))(e,{groupId:t.groupId,groupName:t.groupName,groupLabel:t.groupLabel,visible:t.visible,offsetTop:t.offsetTop});case"CLOSE_OPTION_GROUP_PRESET_MODAL":return(e=>e.setIn(["presets","optionGroupPresetModal","isOptionGroupModalOpen"],!1))(e);case"SET_OPTION_GROUP_PRESET_EDIT_MODE":return((e,{groupId:t,groupName:r,enabled:o})=>e.setIn(["presets","optionGroupPreset"],{groupId:t,groupName:r,isPresetActive:o}))(e,{groupId:t.groupId,groupName:t.groupName,enabled:t.enabled});case"CLOSE_CONFIRMATION_MODAL":return(e=>e.setIn(["presets","confirmationModal"],{isVisible:!1}))(e);case"CLOSE_OPTION_GROUP_CONFIRMATION_MODAL":return(e=>e.setIn(["presets","optionGroupConfirmationModal"],{isVisible:!1}))(e);case"UPDATE_PRESET_NAME":return e.getIn(["presets","isSyncing"])?e:((e,{moduleName:t,presetId:r,name:o,updated:n})=>{const s=D({id:r,moduleName:t,state:e});return e.setIn(["presets","items","module",t,"items",s,"updated"],n).setIn(["presets","items","module",t,"items",s,"name"],o)})(e,{moduleName:t.moduleName,presetId:t.presetId,name:t.name,updated:t.updated});case"ADD_NEW_MODULE_PRESET":return e.getIn(["presets","isSyncing"])?e:((e,{moduleName:t,moduleLabel:r,attrs:o,renderAttrs:s,styleAttrs:a,presetType:i,version:l,created:u,updated:p})=>{const d=e.getIn(["presets","items","module",t,"items"])?.asMutable({deep:!0}),c=Object.values(d??{}).map((e=>e.name)),g=P({presets:c,moduleLabel:r,moduleName:t,type:i,version:l,attrs:o,renderAttrs:s,styleAttrs:a,created:u,updated:p});return(0,n.isArray)(e?.asMutable({deep:!0})?.presets?.items?.module)&&(0,n.isEmpty)(e?.asMutable({deep:!0})?.presets?.items?.module)&&(e=e.setIn(["presets","items","module"],{})),e.setIn(["presets","items","module",t,"items",g.id],g)})(e,{moduleLabel:t.moduleLabel,moduleName:t.moduleName,attrs:t.attrs,renderAttrs:t.renderAttrs,styleAttrs:t.styleAttrs,presetType:t.presetType,version:t.version,created:t.created,updated:t.updated});case"ADD_NEW_MODULE_PRESET_FROM_CURRENT_STYLES":return e.getIn(["presets","isSyncing"])?e:((e,{moduleName:t,moduleLabel:r,attrs:o,renderAttrs:n,styleAttrs:s,presetType:a,version:i,created:l,updated:u})=>{const p=e.getIn(["presets","items","module",t,"items"])?.asMutable({deep:!0}),d=Object.values(p??{}).map((e=>e.name)),c=P({presets:d,moduleLabel:r,moduleName:t,type:a,version:i,attrs:o,renderAttrs:n,styleAttrs:s,created:l,updated:u});return e.setIn(["presets","items","module",t,"items",c.id],c)})(e,{moduleLabel:t.moduleLabel,moduleName:t.moduleName,attrs:t.attrs,renderAttrs:t.renderAttrs,styleAttrs:t.styleAttrs,presetType:t.presetType,version:t.version,created:t.created,updated:t.updated});case"ADD_NEW_OPTION_GROUP_PRESET_FROM_CURRENT_STYLES":return((e,{groupName:t,groupLabel:r,attrs:o,renderAttrs:n,styleAttrs:s,version:a,created:i,updated:l,moduleName:u,groupId:p,primaryAttrName:d})=>{const c=e.getIn(["presets","items","group",t,"items"])?.asMutable({deep:!0}),g=Object.values(c??{}).map((e=>e.name)),m=_({presets:g,groupName:t,groupLabel:r,version:a,attrs:o,renderAttrs:n,styleAttrs:s,created:i,updated:l,moduleName:u,groupId:p,primaryAttrName:d});return e.setIn(["presets","items","group",t,"items",m.id],m)})(e,{moduleId:t.moduleId,groupId:t.groupId,groupName:t.groupName,groupLabel:t.groupLabel,attrs:t.attrs,renderAttrs:t.renderAttrs,styleAttrs:t.styleAttrs,version:t.version,created:t.created,updated:t.updated,moduleName:t.moduleName,primaryAttrName:t.primaryAttrName});case"ADD_DEFAULT_MODULE_PRESET":return e.getIn(["presets","isSyncing"])?e:((e,{moduleName:t,moduleLabel:r,presetType:o,version:n,created:s,updated:a})=>{const i=e.getIn(["presets","items","module",t,"items"]),l=Object.keys(i??{}).length,u=e.getIn(["presets","items","module",t,"default"]);if(l>0&&u)return e;const p=P({type:o,presets:[],moduleLabel:r,moduleName:t,version:n,created:s,updated:a});return l>0&&!u?e.setIn(["presets","items","module",t,"default"],p.id).setIn(["presets","items","module",t,"items"],{[p.id]:p,...i}):e.setIn(["presets","items","module",t,"items"],{[p.id]:p}).setIn(["presets","items","module",t,"default"],p.id)})(e,{moduleName:t.moduleName,moduleLabel:t.moduleLabel,created:t.created,updated:t.updated,version:t.version});case"ADD_DEFAULT_OPTION_GROUP_PRESET":return e.getIn(["presets","isSyncing"])?e:((e,{groupName:t,groupLabel:r,version:o,created:n,updated:s,moduleName:a,groupId:i,primaryAttrName:l})=>{const u=e.getIn(["presets","items","group",t,"items"]),p=Object.keys(u??{}).length,d=e.getIn(["presets","items","group",t,"default"]);if(p>0&&d)return e;const c=_({presets:[],groupLabel:r,groupName:t,version:o,created:n,updated:s,moduleName:a,groupId:i,primaryAttrName:l});return p>0&&!d?e.setIn(["presets","items","group",t,"default"],c.id).setIn(["presets","items","group",t,"items"],{[c.id]:c,...u}):e.setIn(["presets","items","group",t,"items"],{[c.id]:c}).setIn(["presets","items","group",t,"default"],c.id)})(e,{groupLabel:t.groupLabel,groupName:t.groupName,created:t.created,updated:t.updated,moduleName:t.moduleName,groupId:t.groupId,version:t.version,primaryAttrName:t.primaryAttrName});case"IMPORT_PRESETS":return((e,t)=>e.setIn(["presets","items"],e.getIn(["presets","items"]).merge(t,{deep:!0})))(e,t.presets);case"ADD_PRESET_ATTRS_MAP_JOB":return((e,{moduleName:t,id:r,callback:o})=>e.setIn(["presets","attrsMapping","jobs",t,r],o))(e,{moduleName:t.moduleName,id:t.id,callback:t.callback});case"SET_PRESET_ATTRS_MAP":return((e,{moduleName:t,map:r})=>e.setIn(["presets","attrsMapping","maps",t],r).setIn(["presets","attrsMapping","jobs"],e.getIn(["presets","attrsMapping","jobs"]).without(t)))(e,{moduleName:t.moduleName,map:t.map});case"SET_DEFAULT_PRESET_ON_SAVE":return e.getIn(["presets","isSyncing"])?e:((e,{presetType:t,presetSubType:r,presetId:o})=>{const n=(0,d.getSelectedPresetOrDefault)(o,e.getIn(["presets","items",t,r,"default"]));return e.setIn(["presets","defaultOnSave",t,r],n)})(e,{presetType:t.presetType,presetSubType:t.presetSubType,presetId:t.presetId});case"UNSET_DEFAULT_PRESET_ON_SAVE":return e.getIn(["presets","isSyncing"])?e:((e,{presetType:t,presetSubType:r})=>{if(t&&r){const o=e.getIn(["presets","defaultOnSave",t]);return o?e.setIn(["presets","defaultOnSave",t],o.without(r)):e}if(t){const r=e.getIn(["presets","defaultOnSave"]);return r?e.setIn(["presets","defaultOnSave"],r.without(t)):e}return e.setIn(["presets"],e.getIn(["presets"]).without("defaultOnSave"))})(e,{presetType:t.presetType,presetSubType:t.presetSubType});case"END_PRESET_EDIT_SESSION":return((e,t,r,o=null)=>{if(t){if("group"===r){const t=e.getIn(["presets","restorePoint","group"]),r=e.getIn(["presets","optionGroupPreset"])?.asMutable({deep:!0}),s=r?.isPresetActive?r?.groupId:null;if(t&&o&&s&&!(0,n.isEmpty)(t))return(e=e.setIn(["presets","items","group",o],t.getIn([o])?.asMutable({deep:!0}))).setIn(["presets","restorePoint","group"],null);(0,n.isEmpty)(t)||(e=e.setIn(["presets","items","group"],t?.asMutable({deep:!0})))}if("module"===r){const t=e.getIn(["presets","restorePoint","module"]);(0,n.isEmpty)(t)||(e=e.setIn(["presets","items","module"],t?.asMutable({deep:!0})))}if(!r){const t=e.getIn(["presets","restorePoint"]);t&&(e=e.setIn(["presets","items"],t?.asMutable({deep:!0})))}}switch(r){case"group":return e.setIn(["presets","restorePoint","group"],null);case"module":return e.setIn(["presets","restorePoint","module"],null);default:return e.setIn(["presets","restorePoint"],null)}})(e,t.isRollback,t.presetType,t.unsavedPresetGroupName);case"START_PRESET_EDIT_SESSION":return((e,{presetType:t,presetId:r,moduleName:o})=>{if("group"===t)return e.setIn(["presets","restorePoint","group"],e.getIn(["presets","items","group"])?.asMutable({deep:!0})??{});if("module"===t){if(r){const t=e.getIn(["presets","items","module",o,"items"]),n=e.getIn(["presets","items","module",o,"default"]),s=t.getIn([r])?.asMutable({deep:!0})??{};return e.setIn(["presets","restorePoint","module"],e.getIn(["presets","restorePoint","module"])?.asMutable({deep:!0})??{}).setIn(["presets","restorePoint","module",o,"items",r],s).setIn(["presets","restorePoint","module",o,"default"],n)}return e.setIn(["presets","restorePoint","module"],e.getIn(["presets","items","module"])?.asMutable({deep:!0})??{})}return e.setIn(["presets","restorePoint"],e.getIn(["presets","items"])?.asMutable({deep:!0})??{})})(e,{presetType:t.presetType,presetId:t.presetId,moduleName:t.moduleName});case"OVERRIDE_PRESET_DATA":return((e,t)=>e.setIn(["presets","items"],t))(e,t.data);case"END_SYNCING_PRESET":return((e,t)=>e.setIn(["presets","isSyncingError"],t).setIn(["presets","isSyncing"],!1))(e,t.isError);case"START_SYNCING_PRESET":return(e=>e.setIn(["presets","isSyncingError"],!1).setIn(["presets","isSyncing"],!0))(e);case"TOGGLE_PRESET_SAVE_CONFIRMATION_DIALOG":return((e,{flag:t})=>e.setIn(["presets","showPresetSaveConfirmationDialog"],t))(e,{flag:t.flag});case"TOGGLE_OPTION_GROUP_PRESET_SAVE_CONFIRMATION_DIALOG":return((e,{flag:t})=>e.setIn(["presets","optionGroupPreset","showSaveConfirmationDialog"],t))(e,{flag:t.flag});case"UPDATE_OPTION_GROUP_PRESET_WITH_CURRENT_STYLES":return e.getIn(["presets","isSyncing"])?e:((e,{presetId:t,groupName:r,attrs:o,renderAttrs:s,styleAttrs:a,updated:i})=>{const l=L({presetId:t,groupName:r,state:e}),u=e.getIn(["presets","items","group",r,"items"])?.getIn([l]);if(!u)return e;const p={attrs:o,styleAttrs:a,renderAttrs:s};return Object.keys(p).forEach((t=>{const o=p[t],s=u.getIn([t]),a=(0,n.merge)({},s,o);(0,n.isEmpty)(a)||(e=e.setIn(["presets","items","group",r,"items",l,t],a))})),e.setIn(["presets","items","group",r,"items",l,"updated"],i)})(e,{moduleId:t.moduleId,presetId:t.presetId,groupId:t.groupId,groupName:t.groupName,attrs:t.attrs,renderAttrs:t.renderAttrs,styleAttrs:t.styleAttrs,updated:t.updated});case"UPDATE_OPTION_GROUP_PRESET_NAME":return((e,{presetId:t,groupName:r,name:o,updated:n})=>{const s=L({presetId:t,groupName:r,state:e});return e.setIn(["presets","items","group",r,"items",s,"updated"],n).setIn(["presets","items","group",r,"items",s,"name"],o)})(e,{presetId:t.presetId,groupName:t.groupName,name:t.name,updated:t.updated});case"ADD_NEW_OPTION_GROUP_PRESET":return e.getIn(["presets","isSyncing"])?e:((e,{groupName:t,groupLabel:r,attrs:o,renderAttrs:s,styleAttrs:a,version:i,created:l,updated:u,moduleName:p,groupId:d,primaryAttrName:c})=>{const g=e.getIn(["presets","items","group"])?.asMutable({deep:!0});(0,n.isArray)(g)&&(0,n.isEmpty)(g)&&(e=e.setIn(["presets","items","group"],{}));const m=e.getIn(["presets","items","group",t,"items"])?.asMutable({deep:!0}),f=Object.values(m??{}).map((e=>e.name)),b=_({presets:f,groupName:t,groupLabel:r,version:i,attrs:o,renderAttrs:s,styleAttrs:a,created:l,updated:u,moduleName:p,groupId:d,primaryAttrName:c});return e.setIn(["presets","items","group",t,"items",b.id],b)})(e,{groupName:t.groupName,groupLabel:t.groupLabel,attrs:t.attrs,renderAttrs:t.renderAttrs,styleAttrs:t.styleAttrs,version:t.version,created:t.created,updated:t.updated,moduleName:t.moduleName,groupId:t.groupId,primaryAttrName:t.primaryAttrName});case"CLOSE_OPTION_GROUP_PRESET_EDIT_MODE":return((e,t)=>{const{groupId:r,groupName:o}=t||{};return r&&o?e.setIn(["presets","optionGroupPreset"],{groupId:r,groupName:o,isPresetActive:!1}):e.setIn(["presets"],e.getIn(["presets"]).without("optionGroupPreset"))})(e,{groupId:t.groupId,groupName:t.groupName});case"ADD_GLOBAL_VARIABLE":{const{id:r,label:o,value:s,groupKey:a,order:i,status:l,allowedActions:u,lastUpdated:p}=t;return((e,t,r,o,s,a=null,i="active",l={editLabel:!0,editValue:!0,remove:!0,reorder:!0},u=(new Date).toISOString())=>{const p=e.getIn(["globalVariables",s]).asMutable({deep:!0}),d=(0,n.pickBy)(p,(e=>"active"===e.status)),c={id:t,label:r,value:o,order:a=a??Number(Object.keys(d||{}).length)+1,status:i,allowedActions:l,lastUpdated:u,variableType:s};return e.setIn(["globalVariables",s,t],c)})(e,r,o,s,a,i,l,u,p)}case"ADD_GLOBAL_VARIABLES":return((e,{...t})=>e.setIn(["globalVariables"],t))(e,{numbers:t.numbers,strings:t.strings,images:t.images,links:t.links,colors:t.colors,fonts:t.fonts});case"DELETE_GLOBAL_VARIABLE":return((e,t,r)=>{const o=e.getIn(["globalVariables",r,t]);if(!o)return e;if(!o.label||!o.value)return e.setIn(["globalVariables",r],e.getIn(["globalVariables",r]).without(t));const s=e.setIn(["globalVariables",r,t],{...o,status:"archived",order:null}),a=s.getIn(["globalVariables",r]).without((e=>"archived"===e.status));let i=a;return Object.values(a).forEach(((e,t)=>{i=i.setIn([e.id,"order"],t+1)})),e.setIn(["globalVariables",r],(0,n.merge)({...s.getIn(["globalVariables",r]),...i}))})(e,t.id,t.groupKey);case"UPDATE_GLOBAL_VARIABLE":{const{id:r,label:o,value:n,groupKey:s,status:a}=t;return((e,t,r,o,n,s="active")=>{const a=e.getIn(["globalVariables",n,t]);return a?e.setIn(["globalVariables",n,t],{...a,lastUpdated:(new Date).toISOString(),label:r,value:o,status:s}):e})(e,r,o,n,s,a)}case"UPDATE_GLOBAL_VARIABLES":return((e,t)=>((0,n.forEach)(t,(t=>{e=e.setIn(["globalVariables",t.groupKey,t.id],{...t,lastUpdated:t?.lastUpdated??(new Date).toISOString(),label:t.label,value:t.value,status:t?.status??"active"})})),e))(e,t.variables);case"UPDATE_GLOBAL_VARIABLE_ORDER":return((e,t,r,o)=>{const n=e.getIn(["globalVariables",o]);if(!n||!(t in n))return e;const s=Object.values(n).filter((e=>"archived"!==e.status)).sort(((e,t)=>e.order-t.order)),a=s.findIndex((e=>e.id===t)),[i]=s.splice(a,1);s.splice(r-1,0,i);let l=n;return s.forEach(((e,t)=>{l=l.setIn([e.id,"order"],t+1)})),e.setIn(["globalVariables",o],l)})(e,t.id,t.order,t.groupKey);case"UPDATE_GLOBAL_VARIABLES_BACKUP":return(e=>e.setIn(["globalVariablesBackup"],e.getIn(["globalVariables"])))(e);case"RESET_GLOBAL_VARIABLES":return(e=>e.setIn(["globalVariables"],e.getIn(["globalVariablesBackup"])))(e);case"RESTORE_GLOBAL_VARIABLE":return((e,t,r)=>{const o=e.getIn(["globalVariables",r]),s=e.getIn(["globalVariables",r,t]);if(!s)return e;const a=(0,n.pickBy)(o,(e=>"active"===e.status)),i=Number(Object.keys(a).length)+1;return e.setIn(["globalVariables",r,t],{...s,status:"active",order:i})})(e,t.id,t.groupKey);default:return e}},Er=()=>{if((0,l.select)("divi/settings")||(0,c.registerSettingsStore)(),(0,l.select)("divi/fonts")||(0,u.registerFontsStore)(),(0,l.select)("divi/colors")||(0,i.registerColorsStore)(),(0,l.select)("divi/global-data"))return;const r=(e=>{if(!e)return e;if(!e?.group)return e;const t=(0,s.asMutable)(e?.group,{deep:!0});return Object.keys(t).forEach((e=>{const{items:r}=t[e];Object.keys(r).forEach((o=>{(e=>!!e.groupId&&!!e.moduleName)(r[o])||delete t[e].items[o]}))})),e.setIn(["group"],t)})((0,l.select)("divi/settings").getSetting(["globalPresets","data"])),o=(0,l.select)("divi/settings").getSetting(["settings","page","values"],a()({})),g=o?.getIn(["post_content","et_pb_gc_palette"]),f=o?.getIn(["post_content","legacy_global_colors"]),b=o?.getIn(["post_content","et_pb_global_variables"]),E={globalColors:(0,n.isEmpty)(g)?{}:g.asMutable({deep:!0}),previewGlobalColors:{},isGlobalColorEditing:!1,legacyGlobalColors:(0,n.isEmpty)(f)?{}:f.asMutable({deep:!0}),globalVariables:b,globalVariablesBackup:b,fetchLog:{},fetchError:{},presets:{items:(0,d.removeEmptyObjectRecursive)((0,s.asMutable)(r,{deep:!0}),!0),confirmationModal:{isVisible:!1,confirmationAction:null,confirmationText:null,actionPayload:{},actionLabels:{}},optionGroupPresetModal:{groupId:"",isOptionGroupModalOpen:!1,offsetTop:"",groupName:"",groupLabel:""},optionGroupConfirmationModal:{isVisible:!1,confirmationAction:null,confirmationText:null,actionPayload:{},actionLabels:{}},optionGroupPreset:{groupId:"",groupName:"",isPresetActive:!1,showSaveConfirmationDialog:!0},restorePoint:null,defaultOnSave:null,isSyncing:!1,isSyncingError:!1,isActive:!1,showPresetSaveConfirmationDialog:!0,attrsMapping:{jobs:{},maps:{}}}},I=a()(E),y=(0,l.registerStore)("divi/global-data",{actions:e,reducer:br,selectors:t,initialState:I});(0,p.applyMiddlewares)(y,fr),(0,p.applyEffects)(y,mr),m(["fonts","colors"]),(0,l.dispatch)("divi/global-data").updateGlobalVariablesBackup()},Ir=e=>{const{globalColors:t,previewGlobalColors:r,globalVariables:o}=e,s={...o?.numbers,...o?.fonts,...o?.images};let a="",i="",l="";const u={...t,...Object.fromEntries(Object.entries(o?.colors||{}).filter((([,e])=>e?.value)).map((([e,t])=>[e,{color:t.value}])))};return(0,n.forEach)(u,((e,t)=>{if(e?.color){const r=w(e.color);a+=`--${t}: ${r};`}})),(0,n.forEach)(r,(e=>{if(!(0,n.isEmpty)(e)&&e.color){const t=w(e.color);l+=`--${e.colorId}: ${t};`}})),(0,n.forEach)(s,((e,t)=>{if(e?.value){const r=o?.images?.[t]?`url(${e.value})`:e.value;i+=v(t,r)}})),(0,n.isEmpty)(a)?null:lr().createElement(lr().Fragment,null,lr().createElement("style",{className:"et-vb-global-data et-vb-global-colors"},`:root{${a}}`),(0,n.isEmpty)(l)?null:lr().createElement("style",{className:"et-vb-global-data et-vb-preview-global-colors"},`:root{${l}}`),lr().createElement("style",{className:"et-vb-global-data et-vb-global-variables et-vb-global-variables-numbers"},`:root{${i}}`))},yr=()=>{const{globalColors:e,previewGlobalColors:t,globalVariables:r}=(0,l.useSelect)((e=>({globalColors:e("divi/global-data").getGlobalColors(),previewGlobalColors:e("divi/global-data").getPreviewGlobalColors(),globalVariables:e("divi/global-data").getGlobalVariables()})));return(0,ir.useEffect)((()=>{r?.fonts&&(0,n.forEach)(r.fonts,((e,t)=>{e?.value&&t.startsWith("gvid-")&&(0,l.dispatch)("divi/fonts").loadFont(e?.value)}))}),[r?.fonts]),(0,ir.createElement)(Ir,{globalColors:e,previewGlobalColors:t,globalVariables:r})}}(),(window.divi=window.divi||{}).globalData=o}();